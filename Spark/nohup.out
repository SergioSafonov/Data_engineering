[W 10:42:38.892 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 10:42:38.894 NotebookApp] Serving notebooks from local directory: /home/user/spark_code
[I 10:42:38.894 NotebookApp] Jupyter Notebook 6.4.8 is running at:
[I 10:42:38.894 NotebookApp] http://server:8888/?token=e6b016fc5dcbc3785582fe504af69a61cd02f9780c29856e
[I 10:42:38.894 NotebookApp]  or http://127.0.0.1:8888/?token=e6b016fc5dcbc3785582fe504af69a61cd02f9780c29856e
[I 10:42:38.894 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 10:42:38.897 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///home/user/.local/share/jupyter/runtime/nbserver-1611-open.html
    Or copy and paste one of these URLs:
        http://server:8888/?token=e6b016fc5dcbc3785582fe504af69a61cd02f9780c29856e
     or http://127.0.0.1:8888/?token=e6b016fc5dcbc3785582fe504af69a61cd02f9780c29856e
[I 10:43:03.710 NotebookApp] 302 GET /?token=e6b016fc5dcbc3785582fe504af69a61cd02f9780c29856e (192.168.1.51) 0.690000ms
[C 11:25:14.533 NotebookApp] received signal 15, stopping
[I 11:25:14.609 NotebookApp] Shutting down 0 kernels
[I 11:25:14.677 NotebookApp] Shutting down 0 terminals
[W 11:30:28.648 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 11:30:28.650 NotebookApp] Serving notebooks from local directory: /home/user/spark_code
[I 11:30:28.650 NotebookApp] Jupyter Notebook 6.4.8 is running at:
[I 11:30:28.650 NotebookApp] http://server:8888/?token=62e8031817d4a71b803d376957da60dd02cdefea1deebe8b
[I 11:30:28.650 NotebookApp]  or http://127.0.0.1:8888/?token=62e8031817d4a71b803d376957da60dd02cdefea1deebe8b
[I 11:30:28.650 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 11:30:28.654 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///home/user/.local/share/jupyter/runtime/nbserver-2830-open.html
    Or copy and paste one of these URLs:
        http://server:8888/?token=62e8031817d4a71b803d376957da60dd02cdefea1deebe8b
     or http://127.0.0.1:8888/?token=62e8031817d4a71b803d376957da60dd02cdefea1deebe8b
[I 11:30:57.997 NotebookApp] 302 GET /?token=62e8031817d4a71b803d376957da60dd02cdefea1deebe8b (192.168.1.51) 0.570000ms
[W 12:26:12.418 NotebookApp] Notebook Test.ipynb is not trusted
[I 12:26:12.735 NotebookApp] Kernel started: 8e1c36cf-1509-4b4b-98e6-b3e4dd2d0ef5, name: python3
[I 12:27:07.945 NotebookApp] Starting buffering for 8e1c36cf-1509-4b4b-98e6-b3e4dd2d0ef5:a5be5904928942f5ad32434fc8dab657
[I 12:27:08.181 NotebookApp] Kernel restarted: 8e1c36cf-1509-4b4b-98e6-b3e4dd2d0ef5
[I 12:27:08.192 NotebookApp] Restoring connection for 8e1c36cf-1509-4b4b-98e6-b3e4dd2d0ef5:a5be5904928942f5ad32434fc8dab657
[I 12:27:08.843 NotebookApp] Replaying 3 buffered messages
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[I 12:28:12.724 NotebookApp] Saving file at /Test.ipynb
[Stage 0:>                                                          (0 + 1) / 1]                                                                                [Stage 1:>                                                          (0 + 1) / 2][Stage 1:=============================>                             (1 + 1) / 2]                                                                                [Stage 2:>                                                          (0 + 1) / 2]22/04/20 12:29:23 ERROR executor.Executor: Exception in task 0.0 in stage 2.0 (TID 3)
java.io.IOException: No space left on device
	at java.io.FileOutputStream.writeBytes(Native Method)
	at java.io.FileOutputStream.write(FileOutputStream.java:326)
	at org.apache.spark.storage.TimeTrackingOutputStream.write(TimeTrackingOutputStream.java:59)
	at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)
	at java.io.BufferedOutputStream.write(BufferedOutputStream.java:126)
	at net.jpountz.lz4.LZ4BlockOutputStream.flushBufferedData(LZ4BlockOutputStream.java:223)
	at net.jpountz.lz4.LZ4BlockOutputStream.write(LZ4BlockOutputStream.java:176)
	at org.apache.spark.storage.DiskBlockObjectWriter.write(DiskBlockObjectWriter.scala:260)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeSorterSpillWriter.write(UnsafeSorterSpillWriter.java:136)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeExternalSorter.spillIterator(UnsafeExternalSorter.java:544)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeExternalSorter.spill(UnsafeExternalSorter.java:228)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeExternalSorter.createWithExistingInMemorySorter(UnsafeExternalSorter.java:112)
	at org.apache.spark.sql.execution.UnsafeKVExternalSorter.<init>(UnsafeKVExternalSorter.java:158)
	at org.apache.spark.sql.execution.UnsafeFixedWidthAggregationMap.destructAndCreateExternalSorter(UnsafeFixedWidthAggregationMap.java:248)
	at org.apache.spark.sql.execution.aggregate.HashAggregateExec.finishAggregate(HashAggregateExec.scala:461)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:458)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:132)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
22/04/20 12:29:23 WARN scheduler.TaskSetManager: Lost task 0.0 in stage 2.0 (TID 3) (0.0.0.0 executor driver): java.io.IOException: No space left on device
	at java.io.FileOutputStream.writeBytes(Native Method)
	at java.io.FileOutputStream.write(FileOutputStream.java:326)
	at org.apache.spark.storage.TimeTrackingOutputStream.write(TimeTrackingOutputStream.java:59)
	at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)
	at java.io.BufferedOutputStream.write(BufferedOutputStream.java:126)
	at net.jpountz.lz4.LZ4BlockOutputStream.flushBufferedData(LZ4BlockOutputStream.java:223)
	at net.jpountz.lz4.LZ4BlockOutputStream.write(LZ4BlockOutputStream.java:176)
	at org.apache.spark.storage.DiskBlockObjectWriter.write(DiskBlockObjectWriter.scala:260)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeSorterSpillWriter.write(UnsafeSorterSpillWriter.java:136)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeExternalSorter.spillIterator(UnsafeExternalSorter.java:544)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeExternalSorter.spill(UnsafeExternalSorter.java:228)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeExternalSorter.createWithExistingInMemorySorter(UnsafeExternalSorter.java:112)
	at org.apache.spark.sql.execution.UnsafeKVExternalSorter.<init>(UnsafeKVExternalSorter.java:158)
	at org.apache.spark.sql.execution.UnsafeFixedWidthAggregationMap.destructAndCreateExternalSorter(UnsafeFixedWidthAggregationMap.java:248)
	at org.apache.spark.sql.execution.aggregate.HashAggregateExec.finishAggregate(HashAggregateExec.scala:461)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:458)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:132)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

22/04/20 12:29:23 ERROR scheduler.TaskSetManager: Task 0 in stage 2.0 failed 1 times; aborting job
22/04/20 12:29:23 WARN scheduler.TaskSetManager: Lost task 1.0 in stage 2.0 (TID 4) (0.0.0.0 executor driver): TaskKilled (Stage cancelled)
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 12:30:12.705 NotebookApp] Saving file at /Test.ipynb
[W 12:48:39.911 NotebookApp] Notebook lesson_13_2.ipynb is not trusted
[I 12:48:40.285 NotebookApp] Kernel started: 5ef0e6d6-ad53-4f4a-93e3-01b75b516239, name: python3
[I 12:58:25.116 NotebookApp] Kernel started: d6c798d0-1e73-4a43-8595-4259b43085b3, name: python3
[Stage 4:>                                                          (0 + 1) / 2]22/04/20 13:00:50 ERROR executor.Executor: Exception in task 0.0 in stage 4.0 (TID 5)
java.io.IOException: No space left on device
	at java.io.FileOutputStream.writeBytes(Native Method)
	at java.io.FileOutputStream.write(FileOutputStream.java:326)
	at org.apache.spark.storage.TimeTrackingOutputStream.write(TimeTrackingOutputStream.java:59)
	at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)
	at java.io.BufferedOutputStream.write(BufferedOutputStream.java:126)
	at net.jpountz.lz4.LZ4BlockOutputStream.flushBufferedData(LZ4BlockOutputStream.java:223)
	at net.jpountz.lz4.LZ4BlockOutputStream.write(LZ4BlockOutputStream.java:176)
	at org.apache.spark.storage.DiskBlockObjectWriter.write(DiskBlockObjectWriter.scala:260)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeSorterSpillWriter.write(UnsafeSorterSpillWriter.java:136)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeExternalSorter.spillIterator(UnsafeExternalSorter.java:544)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeExternalSorter.spill(UnsafeExternalSorter.java:228)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeExternalSorter.createWithExistingInMemorySorter(UnsafeExternalSorter.java:112)
	at org.apache.spark.sql.execution.UnsafeKVExternalSorter.<init>(UnsafeKVExternalSorter.java:158)
	at org.apache.spark.sql.execution.UnsafeFixedWidthAggregationMap.destructAndCreateExternalSorter(UnsafeFixedWidthAggregationMap.java:248)
	at org.apache.spark.sql.execution.aggregate.HashAggregateExec.finishAggregate(HashAggregateExec.scala:461)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:458)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:132)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
22/04/20 13:00:50 WARN scheduler.TaskSetManager: Lost task 0.0 in stage 4.0 (TID 5) (0.0.0.0 executor driver): java.io.IOException: No space left on device
	at java.io.FileOutputStream.writeBytes(Native Method)
	at java.io.FileOutputStream.write(FileOutputStream.java:326)
	at org.apache.spark.storage.TimeTrackingOutputStream.write(TimeTrackingOutputStream.java:59)
	at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)
	at java.io.BufferedOutputStream.write(BufferedOutputStream.java:126)
	at net.jpountz.lz4.LZ4BlockOutputStream.flushBufferedData(LZ4BlockOutputStream.java:223)
	at net.jpountz.lz4.LZ4BlockOutputStream.write(LZ4BlockOutputStream.java:176)
	at org.apache.spark.storage.DiskBlockObjectWriter.write(DiskBlockObjectWriter.scala:260)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeSorterSpillWriter.write(UnsafeSorterSpillWriter.java:136)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeExternalSorter.spillIterator(UnsafeExternalSorter.java:544)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeExternalSorter.spill(UnsafeExternalSorter.java:228)
	at org.apache.spark.util.collection.unsafe.sort.UnsafeExternalSorter.createWithExistingInMemorySorter(UnsafeExternalSorter.java:112)
	at org.apache.spark.sql.execution.UnsafeKVExternalSorter.<init>(UnsafeKVExternalSorter.java:158)
	at org.apache.spark.sql.execution.UnsafeFixedWidthAggregationMap.destructAndCreateExternalSorter(UnsafeFixedWidthAggregationMap.java:248)
	at org.apache.spark.sql.execution.aggregate.HashAggregateExec.finishAggregate(HashAggregateExec.scala:461)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:458)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:132)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

22/04/20 13:00:50 ERROR scheduler.TaskSetManager: Task 0 in stage 4.0 failed 1 times; aborting job
22/04/20 13:00:50 WARN scheduler.TaskSetManager: Lost task 1.0 in stage 4.0 (TID 6) (0.0.0.0 executor driver): TaskKilled (Stage cancelled)
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
                                                        [W 19:00:35.370 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 19:00:35.372 NotebookApp] Serving notebooks from local directory: /home/user/spark_code
[I 19:00:35.372 NotebookApp] Jupyter Notebook 6.4.8 is running at:
[I 19:00:35.372 NotebookApp] http://server:8888/?token=54bea5ac9c000583dbe8b4b8ba021682a67532c521ceea99
[I 19:00:35.372 NotebookApp]  or http://127.0.0.1:8888/?token=54bea5ac9c000583dbe8b4b8ba021682a67532c521ceea99
[I 19:00:35.372 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 19:00:35.376 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///home/user/.local/share/jupyter/runtime/nbserver-5693-open.html
    Or copy and paste one of these URLs:
        http://server:8888/?token=54bea5ac9c000583dbe8b4b8ba021682a67532c521ceea99
     or http://127.0.0.1:8888/?token=54bea5ac9c000583dbe8b4b8ba021682a67532c521ceea99
[I 19:01:01.204 NotebookApp] 302 GET /?token=54bea5ac9c000583dbe8b4b8ba021682a67532c521ceea99 (192.168.1.51) 0.610000ms
[I 19:01:07.830 NotebookApp] Kernel started: 7fe47587-1ca3-4e36-a86f-867cd44d957d, name: python3
[I 19:04:26.801 NotebookApp] Starting buffering for 7fe47587-1ca3-4e36-a86f-867cd44d957d:8e9b94982df74ac8a5f8f8d0edd5c41d
[I 19:04:27.038 NotebookApp] Kernel restarted: 7fe47587-1ca3-4e36-a86f-867cd44d957d
[I 19:04:27.047 NotebookApp] Restoring connection for 7fe47587-1ca3-4e36-a86f-867cd44d957d:8e9b94982df74ac8a5f8f8d0edd5c41d
[I 19:04:28.055 NotebookApp] Replaying 3 buffered messages
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[Stage 0:>                                                          (0 + 1) / 1]                                                                                [Stage 1:>                                                          (0 + 1) / 2][Stage 1:=============================>                             (1 + 1) / 2][I 19:05:07.930 NotebookApp] Saving file at /Test.ipynb
                                                                                [Stage 2:>                                                          (0 + 1) / 2][Stage 2:=============================>                             (1 + 1) / 2]                                                                                [Stage 4:>                                                          (0 + 1) / 2][Stage 4:=============================>                             (1 + 1) / 2][I 19:07:07.985 NotebookApp] Saving file at /Test.ipynb
                                                                                [I 19:07:34.843 NotebookApp] Kernel started: 3e578fd0-d4ee-413b-a3eb-5ebd502953da, name: python3
[I 19:09:08.537 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 19:11:08.600 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 19:13:08.160 NotebookApp] Saving file at /Test.ipynb
[Stage 6:>                                                          (0 + 1) / 2][Stage 6:=============================>                             (1 + 1) / 2][Stage 7:==>                                                     (10 + 1) / 200][Stage 7:===>                                                    (14 + 1) / 200][Stage 7:=====>                                                  (18 + 1) / 200][Stage 7:=====>                                                  (21 + 1) / 200][Stage 7:=======>                                                (26 + 1) / 200][Stage 7:========>                                               (30 + 1) / 200][Stage 7:=========>                                              (34 + 1) / 200][Stage 7:==========>                                             (39 + 1) / 200][Stage 7:============>                                           (43 + 1) / 200][Stage 7:=============>                                          (48 + 1) / 200][Stage 7:==============>                                         (53 + 1) / 200][Stage 7:================>                                       (58 + 1) / 200][Stage 7:=================>                                      (63 + 1) / 200][Stage 7:===================>                                    (68 + 2) / 200][Stage 7:====================>                                   (74 + 1) / 200][Stage 7:=====================>                                  (78 + 2) / 200][Stage 7:=======================>                                (83 + 1) / 200][Stage 7:========================>                               (87 + 1) / 200][Stage 7:=========================>                              (92 + 1) / 200][Stage 7:===========================>                            (97 + 1) / 200][Stage 7:============================>                          (104 + 1) / 200][Stage 7:==============================>                        (110 + 1) / 200][Stage 7:===============================>                       (115 + 1) / 200][Stage 7:=================================>                     (120 + 2) / 200][Stage 7:==================================>                    (126 + 1) / 200][Stage 7:====================================>                  (132 + 1) / 200][Stage 7:=====================================>                 (137 + 1) / 200][Stage 7:======================================>                (141 + 1) / 200][Stage 7:========================================>              (146 + 1) / 200][Stage 7:=========================================>             (150 + 1) / 200][Stage 7:==========================================>            (156 + 1) / 200][Stage 7:============================================>          (161 + 1) / 200][Stage 7:=============================================>         (165 + 1) / 200][Stage 7:==============================================>        (170 + 1) / 200][Stage 7:================================================>      (177 + 1) / 200][Stage 7:==================================================>    (183 + 1) / 200][Stage 7:====================================================>  (190 + 1) / 200][Stage 7:=====================================================> (196 + 1) / 200][Stage 8:>                                                          (0 + 1) / 1]                                                                                [IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 19:15:08.224 NotebookApp] Saving file at /Test.ipynb
[Stage 18:>                                                         (0 + 1) / 2][Stage 18:=============================>                            (1 + 1) / 2][Stage 19:====>                                                  (15 + 1) / 200][Stage 19:=====>                                                 (21 + 1) / 200][Stage 19:=======>                                               (27 + 1) / 200][Stage 19:=========>                                             (33 + 1) / 200][Stage 19:===========>                                           (40 + 1) / 200][Stage 19:============>                                          (45 + 1) / 200][Stage 19:=============>                                         (50 + 1) / 200][Stage 19:===============>                                       (57 + 1) / 200][Stage 19:=================>                                     (63 + 1) / 200][Stage 19:===================>                                   (71 + 1) / 200][Stage 19:=====================>                                 (77 + 1) / 200][Stage 19:======================>                                (83 + 1) / 200][Stage 19:========================>                              (88 + 1) / 200][Stage 19:==========================>                            (95 + 1) / 200][Stage 19:===========================>                          (102 + 1) / 200][Stage 19:============================>                         (107 + 1) / 200][Stage 19:==============================>                       (113 + 1) / 200][Stage 19:================================>                     (119 + 1) / 200][Stage 19:=================================>                    (124 + 1) / 200][Stage 19:===================================>                  (130 + 1) / 200][Stage 19:====================================>                 (136 + 1) / 200][Stage 19:======================================>               (143 + 1) / 200][Stage 19:========================================>             (149 + 1) / 200][Stage 19:==========================================>           (156 + 1) / 200][Stage 19:===========================================>          (162 + 1) / 200][Stage 19:=============================================>        (169 + 1) / 200][Stage 19:==============================================>       (174 + 1) / 200][Stage 19:================================================>     (180 + 1) / 200][Stage 19:==================================================>   (187 + 1) / 200][Stage 19:====================================================> (193 + 1) / 200][Stage 19:=====================================================>(199 + 1) / 200]                                                                                [I 19:17:08.283 NotebookApp] Saving file at /Test.ipynb
[I 19:19:08.320 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 19:21:08.326 NotebookApp] Saving file at /Test.ipynb
[I 19:23:08.324 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 19:25:08.323 NotebookApp] Saving file at /Test.ipynb
[I 19:27:08.321 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[Stage 30:>                                                         (0 + 1) / 2][Stage 30:=============================>                            (1 + 1) / 2][Stage 31:====>                                                  (17 + 1) / 200][Stage 31:======>                                                (25 + 1) / 200][Stage 31:========>                                              (31 + 1) / 200][Stage 31:==========>                                            (39 + 1) / 200][Stage 31:============>                                          (46 + 1) / 200][Stage 31:==============>                                        (53 + 1) / 200][Stage 31:================>                                      (60 + 1) / 200][Stage 31:==================>                                    (66 + 1) / 200][Stage 31:===================>                                   (72 + 1) / 200][Stage 31:======================>                                (80 + 1) / 200][Stage 31:=======================>                               (85 + 1) / 200][Stage 31:=========================>                             (92 + 0) / 200][Stage 31:==========================>                            (98 + 1) / 200][Stage 31:============================>                         (104 + 1) / 200][Stage 31:=============================>                        (110 + 1) / 200][Stage 31:===============================>                      (117 + 1) / 200][Stage 31:=================================>                    (124 + 1) / 200][Stage 31:===================================>                  (131 + 1) / 200][Stage 31:====================================>                 (137 + 1) / 200][Stage 31:======================================>               (142 + 2) / 200][Stage 31:========================================>             (149 + 1) / 200][Stage 31:=========================================>            (154 + 1) / 200][Stage 31:==========================================>           (159 + 1) / 200][Stage 31:============================================>         (163 + 1) / 200][Stage 31:=============================================>        (168 + 1) / 200][Stage 31:==============================================>       (173 + 1) / 200][Stage 31:===============================================>      (177 + 1) / 200][Stage 31:=================================================>    (182 + 1) / 200][Stage 31:==================================================>   (187 + 1) / 200][Stage 31:====================================================> (193 + 1) / 200][Stage 31:=====================================================>(199 + 1) / 200]                                                                                [IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 19:29:08.817 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 19:31:08.324 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[Stage 42:>                                                         (0 + 1) / 2][I 19:33:08.327 NotebookApp] Saving file at /Test.ipynb
[Stage 42:=============================>                            (1 + 1) / 2][Stage 43:====>                                                  (18 + 1) / 200][Stage 43:=======>                                               (26 + 1) / 200][Stage 43:========>                                              (32 + 1) / 200][Stage 43:==========>                                            (38 + 1) / 200][Stage 43:============>                                          (45 + 1) / 200][Stage 43:==============>                                        (52 + 1) / 200][Stage 43:===============>                                       (58 + 1) / 200][Stage 43:=================>                                     (63 + 1) / 200][Stage 43:==================>                                    (68 + 1) / 200][Stage 43:====================>                                  (73 + 1) / 200][Stage 43:=====================>                                 (78 + 1) / 200][Stage 43:======================>                                (83 + 1) / 200][Stage 43:========================>                              (88 + 1) / 200][Stage 43:=========================>                             (92 + 1) / 200][Stage 43:==========================>                            (96 + 1) / 200][Stage 43:===========================>                          (100 + 1) / 200][Stage 43:============================>                         (106 + 1) / 200][Stage 43:==============================>                       (112 + 1) / 200][Stage 43:===============================>                      (118 + 1) / 200][Stage 43:=================================>                    (125 + 1) / 200][Stage 43:===================================>                  (131 + 1) / 200][Stage 43:=====================================>                (139 + 1) / 200][Stage 43:=======================================>              (146 + 1) / 200][Stage 43:=========================================>            (154 + 1) / 200][Stage 43:==========================================>           (159 + 1) / 200][Stage 43:============================================>         (166 + 1) / 200][Stage 43:==============================================>       (172 + 1) / 200][Stage 43:================================================>     (179 + 1) / 200][Stage 43:=================================================>    (185 + 1) / 200][Stage 43:===================================================>  (190 + 1) / 200][Stage 43:=====================================================>(197 + 1) / 200]                                                                                [Stage 54:>                                                         (0 + 1) / 2][Stage 54:=============================>                            (1 + 1) / 2][I 19:35:08.325 NotebookApp] Saving file at /Test.ipynb
[Stage 55:=====>                                                 (20 + 1) / 200][Stage 55:=======>                                               (26 + 1) / 200][Stage 55:=========>                                             (33 + 1) / 200][Stage 55:==========>                                            (39 + 1) / 200][Stage 55:============>                                          (47 + 1) / 200][Stage 55:==============>                                        (54 + 1) / 200][Stage 55:================>                                      (60 + 1) / 200][Stage 55:==================>                                    (67 + 1) / 200][Stage 55:====================>                                  (74 + 1) / 200][Stage 55:======================>                                (81 + 1) / 200][Stage 55:========================>                              (88 + 1) / 200][Stage 55:==========================>                            (95 + 1) / 200][Stage 55:===========================>                          (102 + 1) / 200][Stage 55:=============================>                        (108 + 1) / 200][Stage 55:===============================>                      (116 + 1) / 200][Stage 55:=================================>                    (123 + 1) / 200][Stage 55:==================================>                   (128 + 1) / 200][Stage 55:====================================>                 (134 + 1) / 200][Stage 55:=====================================>                (138 + 1) / 200][Stage 55:=======================================>              (145 + 1) / 200][Stage 55:========================================>             (151 + 1) / 200][Stage 55:==========================================>           (156 + 1) / 200][Stage 55:===========================================>          (161 + 1) / 200][Stage 55:=============================================>        (168 + 1) / 200][Stage 55:==============================================>       (174 + 1) / 200][Stage 55:================================================>     (181 + 1) / 200][Stage 55:==================================================>   (187 + 1) / 200][Stage 55:====================================================> (194 + 1) / 200]                                                                                [I 19:37:08.324 NotebookApp] Saving file at /Test.ipynb
[I 20:45:59.229 NotebookApp] Starting buffering for 3e578fd0-d4ee-413b-a3eb-5ebd502953da:753630fc3c074f30831f0637a422ccb8
[W 20:46:15.616 NotebookApp] Notebook lesson_16_streaming.ipynb is not trusted
[I 20:46:15.868 NotebookApp] Kernel started: 3391877e-1a7a-42c2-bdb9-42e36bbaa5c7, name: python3
[I 20:46:32.056 NotebookApp] Starting buffering for 3391877e-1a7a-42c2-bdb9-42e36bbaa5c7:daf68db3ad64490e883ffe6b81216651
[W 20:46:46.945 NotebookApp] delete /hs_err_pid20490.log
[W 20:46:50.810 NotebookApp] Notebook lambda_architecture_streaming.ipynb is not trusted
[I 20:46:51.156 NotebookApp] Kernel started: 9fca2e6b-7217-420c-8917-0bf91dda4547, name: python3
[W 11:32:57.047 NotebookApp] WebSocket ping timeout after 41129998 ms.
[I 11:33:02.050 NotebookApp] Starting buffering for 7fe47587-1ca3-4e36-a86f-867cd44d957d:8e9b94982df74ac8a5f8f8d0edd5c41d
[W 11:33:21.809 NotebookApp] WebSocket ping timeout after 41159999 ms.
[I 11:33:26.815 NotebookApp] Starting buffering for 9fca2e6b-7217-420c-8917-0bf91dda4547:84ade81e3c8548eb9ab41a7ce084f4f3
[W 11:35:04.584 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 11:35:04.586 NotebookApp] The port 8888 is already in use, trying another port.
[I 11:35:04.586 NotebookApp] Serving notebooks from local directory: /home/user/spark_code
[I 11:35:04.586 NotebookApp] Jupyter Notebook 6.4.8 is running at:
[I 11:35:04.587 NotebookApp] http://server:8889/?token=5d95fef85e40b388b795fd9ec4def49c27059f3c8a458038
[I 11:35:04.587 NotebookApp]  or http://127.0.0.1:8889/?token=5d95fef85e40b388b795fd9ec4def49c27059f3c8a458038
[I 11:35:04.587 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 11:35:04.590 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///home/user/.local/share/jupyter/runtime/nbserver-22324-open.html
    Or copy and paste one of these URLs:
        http://server:8889/?token=5d95fef85e40b388b795fd9ec4def49c27059f3c8a458038
     or http://127.0.0.1:8889/?token=5d95fef85e40b388b795fd9ec4def49c27059f3c8a458038
[I 11:36:01.586 NotebookApp] 302 GET /?token=5d95fef85e40b388b795fd9ec4def49c27059f3c8a458038 (192.168.1.51) 0.560000ms
[W 11:36:22.842 NotebookApp] Notebook Test.ipynb is not trusted
[I 11:36:23.181 NotebookApp] Kernel started: 969c3ceb-6a2b-4661-8bf1-e1409150c8ab, name: python3
[I 11:36:29.046 NotebookApp] Starting buffering for 969c3ceb-6a2b-4661-8bf1-e1409150c8ab:d4dd2e9454484a3681ea28420fa52fe7
[I 11:36:29.280 NotebookApp] Kernel restarted: 969c3ceb-6a2b-4661-8bf1-e1409150c8ab
[I 11:36:29.290 NotebookApp] Restoring connection for 969c3ceb-6a2b-4661-8bf1-e1409150c8ab:d4dd2e9454484a3681ea28420fa52fe7
[I 11:36:30.061 NotebookApp] Replaying 3 buffered messages
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
22/04/21 11:36:37 WARN util.Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
22/04/21 11:36:37 WARN util.Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
[I 11:38:23.825 NotebookApp] Saving file at /Test.ipynb
[W 12:25:35.926 NotebookApp] Notebook lambda_architecture_streaming.ipynb is not trusted
[I 12:25:36.254 NotebookApp] Kernel started: 75272230-bfae-4774-a0f0-21ef24cd4d59, name: python3
22/04/21 21:29:36 WARN spark.HeartbeatReceiver: Removing executor driver with no recent heartbeats: 12953203 ms exceeds timeout 120000 ms
[W 21:29:36.911 NotebookApp] WebSocket ping timeout after 12959988 ms.
22/04/21 21:29:37 WARN spark.SparkContext: Killing executors is not supported by current scheduler.
[W 21:29:38.964 NotebookApp] Replacing stale connection: 75272230-bfae-4774-a0f0-21ef24cd4d59:33b72699a92f47d28aac610d46633829
[I 21:29:41.914 NotebookApp] Starting buffering for 75272230-bfae-4774-a0f0-21ef24cd4d59:33b72699a92f47d28aac610d46633829
[I 21:29:41.915 NotebookApp] Restoring connection for 75272230-bfae-4774-a0f0-21ef24cd4d59:33b72699a92f47d28aac610d46633829
[W 21:29:41.928 NotebookApp] Replacing stale connection: 969c3ceb-6a2b-4661-8bf1-e1409150c8ab:d4dd2e9454484a3681ea28420fa52fe7
[I 21:29:46.930 NotebookApp] Starting buffering for 969c3ceb-6a2b-4661-8bf1-e1409150c8ab:d4dd2e9454484a3681ea28420fa52fe7
[I 21:29:46.933 NotebookApp] Restoring connection for 969c3ceb-6a2b-4661-8bf1-e1409150c8ab:d4dd2e9454484a3681ea28420fa52fe7
[W 23:30:35.896 NotebookApp] Replacing stale connection: 75272230-bfae-4774-a0f0-21ef24cd4d59:33b72699a92f47d28aac610d46633829
[I 23:30:40.901 NotebookApp] Starting buffering for 75272230-bfae-4774-a0f0-21ef24cd4d59:33b72699a92f47d28aac610d46633829
[I 23:30:40.902 NotebookApp] Restoring connection for 75272230-bfae-4774-a0f0-21ef24cd4d59:33b72699a92f47d28aac610d46633829
[W 23:30:40.914 NotebookApp] Replacing stale connection: 969c3ceb-6a2b-4661-8bf1-e1409150c8ab:d4dd2e9454484a3681ea28420fa52fe7
[I 23:30:45.917 NotebookApp] Starting buffering for 969c3ceb-6a2b-4661-8bf1-e1409150c8ab:d4dd2e9454484a3681ea28420fa52fe7
[I 23:30:45.918 NotebookApp] Restoring connection for 969c3ceb-6a2b-4661-8bf1-e1409150c8ab:d4dd2e9454484a3681ea28420fa52fe7
[W 10:53:58.048 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 10:53:58.050 NotebookApp] Serving notebooks from local directory: /home/user/spark_code
[I 10:53:58.050 NotebookApp] Jupyter Notebook 6.4.8 is running at:
[I 10:53:58.050 NotebookApp] http://server:8888/?token=6e1df09603e65d2defa4121f70fa2213be694225db6b2be4
[I 10:53:58.050 NotebookApp]  or http://127.0.0.1:8888/?token=6e1df09603e65d2defa4121f70fa2213be694225db6b2be4
[I 10:53:58.050 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 10:53:58.052 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///home/user/.local/share/jupyter/runtime/nbserver-3325-open.html
    Or copy and paste one of these URLs:
        http://server:8888/?token=6e1df09603e65d2defa4121f70fa2213be694225db6b2be4
     or http://127.0.0.1:8888/?token=6e1df09603e65d2defa4121f70fa2213be694225db6b2be4
[I 10:54:25.015 NotebookApp] 302 GET /?token=6e1df09603e65d2defa4121f70fa2213be694225db6b2be4 (192.168.1.51) 0.360000ms
[W 11:19:22.160 NotebookApp] Notebook lesson_13_2.ipynb is not trusted
[I 11:19:22.559 NotebookApp] Kernel started: b2a34b42-a8f4-41c4-b734-4038ac788aaa, name: python3
[W 11:35:12.932 NotebookApp] Notebook lambda_architecture_streaming.ipynb is not trusted
[I 11:35:13.395 NotebookApp] Kernel started: 66f2187e-a574-42b5-a97b-c387ff4b88e9, name: python3
[I 12:35:20.578 NotebookApp] Kernel started: cbe20edb-6cd4-4869-94f6-02ee3bf3b544, name: python3
[I 12:35:25.889 NotebookApp] Starting buffering for cbe20edb-6cd4-4869-94f6-02ee3bf3b544:495192ca603a4961842d7f241ca63eb7
[I 12:35:26.128 NotebookApp] Kernel restarted: cbe20edb-6cd4-4869-94f6-02ee3bf3b544
[I 12:35:26.137 NotebookApp] Restoring connection for cbe20edb-6cd4-4869-94f6-02ee3bf3b544:495192ca603a4961842d7f241ca63eb7
[I 12:35:26.896 NotebookApp] Replaying 3 buffered messages
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[I 12:37:20.580 NotebookApp] Saving file at /Test.ipynb
[I 12:39:20.654 NotebookApp] Saving file at /Test.ipynb
[I 12:41:20.571 NotebookApp] Saving file at /Test.ipynb
[I 12:43:20.564 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[Stage 0:>                                                          (0 + 1) / 1]                                                                                [I 12:45:20.567 NotebookApp] Saving file at /Test.ipynb
[I 12:47:20.562 NotebookApp] Saving file at /Test.ipynb
[I 12:49:20.569 NotebookApp] Saving file at /Test.ipynb
[Stage 8:==========================>                             (47 + 1) / 100][Stage 8:==================================>                     (62 + 1) / 100][Stage 8:===========================================>            (78 + 1) / 100][Stage 8:====================================================>   (94 + 1) / 100]                                                                                [Stage 10:==========================================>             (57 + 1) / 75][Stage 10:===================================================>    (69 + 1) / 75]                                                                                [I 12:51:20.570 NotebookApp] Saving file at /Test.ipynb
[I 12:53:20.569 NotebookApp] Saving file at /Test.ipynb
[Stage 19:================================================>      (89 + 1) / 100]                                                                                [I 12:55:20.568 NotebookApp] Saving file at /Test.ipynb
22/04/22 17:40:54 WARN spark.HeartbeatReceiver: Removing executor driver with no recent heartbeats: 3938115 ms exceeds timeout 120000 ms
22/04/22 17:40:55 WARN spark.SparkContext: Killing executors is not supported by current scheduler.
[I 17:40:56.486 NotebookApp] Saving file at /Test.ipynb
[I 19:26:05.966 NotebookApp] Starting buffering for b2a34b42-a8f4-41c4-b734-4038ac788aaa:bcbe48d0043a48c49dc4674191b9d1e8
[I 19:26:11.531 NotebookApp] Starting buffering for 66f2187e-a574-42b5-a97b-c387ff4b88e9:409c115b3ab3421f880184662431ea97
[I 19:26:16.467 NotebookApp] Starting buffering for cbe20edb-6cd4-4869-94f6-02ee3bf3b544:495192ca603a4961842d7f241ca63eb7
[W 16:20:55.522 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 16:20:55.523 NotebookApp] The port 8888 is already in use, trying another port.
[I 16:20:55.524 NotebookApp] Serving notebooks from local directory: /home/user/spark_code
[I 16:20:55.524 NotebookApp] Jupyter Notebook 6.4.8 is running at:
[I 16:20:55.524 NotebookApp] http://server:8889/?token=23acdde7c27a87c194913f92f9ba92042e77a49d9989389a
[I 16:20:55.524 NotebookApp]  or http://127.0.0.1:8889/?token=23acdde7c27a87c194913f92f9ba92042e77a49d9989389a
[I 16:20:55.524 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 16:20:55.526 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///home/user/.local/share/jupyter/runtime/nbserver-24966-open.html
    Or copy and paste one of these URLs:
        http://server:8889/?token=23acdde7c27a87c194913f92f9ba92042e77a49d9989389a
     or http://127.0.0.1:8889/?token=23acdde7c27a87c194913f92f9ba92042e77a49d9989389a
[I 16:21:22.296 NotebookApp] 302 GET /?token=23acdde7c27a87c194913f92f9ba92042e77a49d9989389a (192.168.1.51) 0.550000ms
[W 10:35:28.090 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 10:35:28.092 NotebookApp] The port 8888 is already in use, trying another port.
[I 10:35:28.092 NotebookApp] The port 8889 is already in use, trying another port.
[I 10:35:28.093 NotebookApp] Serving notebooks from local directory: /home/user/spark_code
[I 10:35:28.093 NotebookApp] Jupyter Notebook 6.4.8 is running at:
[I 10:35:28.093 NotebookApp] http://server:8890/?token=bada2e9d0980d5f383cf5a225ed71f25bfe68091e8a54cff
[I 10:35:28.093 NotebookApp]  or http://127.0.0.1:8890/?token=bada2e9d0980d5f383cf5a225ed71f25bfe68091e8a54cff
[I 10:35:28.093 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 10:35:28.096 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///home/user/.local/share/jupyter/runtime/nbserver-6562-open.html
    Or copy and paste one of these URLs:
        http://server:8890/?token=bada2e9d0980d5f383cf5a225ed71f25bfe68091e8a54cff
     or http://127.0.0.1:8890/?token=bada2e9d0980d5f383cf5a225ed71f25bfe68091e8a54cff
[I 10:35:59.939 NotebookApp] 302 GET /?token=bada2e9d0980d5f383cf5a225ed71f25bfe68091e8a54cff (192.168.1.51) 0.430000ms
[W 10:38:41.419 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 10:38:41.420 NotebookApp] The port 8888 is already in use, trying another port.
[I 10:38:41.420 NotebookApp] The port 8889 is already in use, trying another port.
[I 10:38:41.421 NotebookApp] The port 8890 is already in use, trying another port.
[I 10:38:41.421 NotebookApp] Serving notebooks from local directory: /home/user/spark_code
[I 10:38:41.421 NotebookApp] Jupyter Notebook 6.4.8 is running at:
[I 10:38:41.421 NotebookApp] http://server:8891/?token=efed08db41dc29564e1a963fab2fca1b1e0047f7cc196687
[I 10:38:41.421 NotebookApp]  or http://127.0.0.1:8891/?token=efed08db41dc29564e1a963fab2fca1b1e0047f7cc196687
[I 10:38:41.421 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 10:38:41.423 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///home/user/.local/share/jupyter/runtime/nbserver-21524-open.html
    Or copy and paste one of these URLs:
        http://server:8891/?token=efed08db41dc29564e1a963fab2fca1b1e0047f7cc196687
     or http://127.0.0.1:8891/?token=efed08db41dc29564e1a963fab2fca1b1e0047f7cc196687
[I 10:39:20.647 NotebookApp] 302 GET /?token=efed08db41dc29564e1a963fab2fca1b1e0047f7cc196687 (192.168.0.15) 0.790000ms
[W 10:53:25.745 NotebookApp] Notebook Test.ipynb is not trusted
[I 10:53:26.068 NotebookApp] Kernel started: 8f378dcf-b7eb-4949-a252-29df27c582ad, name: python3
[I 10:53:31.444 NotebookApp] Starting buffering for 8f378dcf-b7eb-4949-a252-29df27c582ad:878fd477e51447c38bb2ad15aef83437
[I 10:53:31.680 NotebookApp] Kernel restarted: 8f378dcf-b7eb-4949-a252-29df27c582ad
[I 10:53:31.692 NotebookApp] Restoring connection for 8f378dcf-b7eb-4949-a252-29df27c582ad:878fd477e51447c38bb2ad15aef83437
[I 10:53:33.131 NotebookApp] Replaying 3 buffered messages
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
22/04/27 10:53:39 WARN util.Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
22/04/27 10:53:39 WARN util.Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
[Stage 0:>                                                          (0 + 1) / 1]                                                                                [I 10:55:26.105 NotebookApp] Saving file at /Test.ipynb
[Stage 8:============================>                           (51 + 1) / 100][Stage 8:=======================================>                (71 + 1) / 100][Stage 8:====================================================>   (93 + 1) / 100]                                                                                [Stage 10:=======================================================>(74 + 1) / 75]                                                                                [I 10:57:26.893 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 10:59:25.993 NotebookApp] Saving file at /Test.ipynb
[Stage 12:>                                                       (0 + 1) / 200][Stage 12:=>                                                      (6 + 1) / 200][Stage 12:====>                                                  (17 + 1) / 200][Stage 12:======>                                                (24 + 1) / 200][Stage 12:=========>                                             (34 + 1) / 200][Stage 12:============>                                          (47 + 1) / 200][Stage 12:==============>                                        (54 + 2) / 200][Stage 12:=================>                                     (64 + 1) / 200][Stage 12:=====================>                                 (77 + 1) / 200][Stage 12:========================>                              (89 + 1) / 200][Stage 12:==========================>                            (97 + 1) / 200][Stage 12:============================>                         (106 + 1) / 200][Stage 12:===============================>                      (116 + 1) / 200][Stage 12:==================================>                   (128 + 1) / 200][Stage 12:=====================================>                (140 + 1) / 200][Stage 12:=========================================>            (152 + 1) / 200][Stage 12:============================================>         (163 + 1) / 200][Stage 12:=============================================>        (169 + 1) / 200][Stage 12:=================================================>    (182 + 1) / 200][Stage 12:====================================================> (193 + 2) / 200]                                                                                [W 11:00:43.775 NotebookApp] Notebook lesson_13_2.ipynb is not trusted
[I 11:00:44.207 NotebookApp] Kernel started: ef3e8642-8ce6-420a-a8c7-337787a168bf, name: python3
[I 11:01:26.781 NotebookApp] Saving file at /Test.ipynb
[I 11:11:26.024 NotebookApp] Saving file at /Test.ipynb
[I 11:13:25.967 NotebookApp] Saving file at /Test.ipynb
[I 11:15:25.905 NotebookApp] Saving file at /Test.ipynb
[I 11:33:59.812 NotebookApp] Kernel started: dde176cf-8deb-4ab8-acab-172808121c73, name: python3
[I 11:35:25.652 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 11:37:25.593 NotebookApp] Saving file at /Test.ipynb
[I 11:39:26.365 NotebookApp] Saving file at /Test.ipynb
[Stage 33:======================================>                   (2 + 1) / 3]                                                                                [I 11:41:26.305 NotebookApp] Saving file at /Test.ipynb
[I 11:59:26.140 NotebookApp] Saving file at /Test.ipynb
[I 12:01:26.132 NotebookApp] Saving file at /Test.ipynb
[I 12:03:25.249 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 12:53:24.576 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 12:55:24.502 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 12:57:25.273 NotebookApp] Saving file at /Test.ipynb
[I 13:01:25.382 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 13:11:25.272 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 13:13:25.214 NotebookApp] Saving file at /Test.ipynb
[I 13:15:24.310 NotebookApp] Saving file at /Test.ipynb
[Stage 53:>                                                         (0 + 1) / 1]                                                                                [I 13:17:24.259 NotebookApp] Saving file at /Test.ipynb
[I 13:19:24.309 NotebookApp] Saving file at /Test.ipynb
[I 13:21:24.383 NotebookApp] Saving file at /Test.ipynb
[I 13:23:24.437 NotebookApp] Saving file at /Test.ipynb
22/04/27 13:23:35 ERROR executor.Executor: Exception in task 0.0 in stage 58.0 (TID 654)
java.io.FileNotFoundException: File does not exist: hdfs://master:9000/datalake/silver/currencies/RUB_EUR/rate_month=4/part-00017-af47337b-61d2-4ad1-9aa4-dd838553b208.c000.snappy.parquet
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:169)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:503)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:225)
	at org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
22/04/27 13:23:35 WARN scheduler.TaskSetManager: Lost task 0.0 in stage 58.0 (TID 654) (0.0.0.0 executor driver): java.io.FileNotFoundException: File does not exist: hdfs://master:9000/datalake/silver/currencies/RUB_EUR/rate_month=4/part-00017-af47337b-61d2-4ad1-9aa4-dd838553b208.c000.snappy.parquet
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:169)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:503)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:225)
	at org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

22/04/27 13:23:35 ERROR scheduler.TaskSetManager: Task 0 in stage 58.0 failed 1 times; aborting job
22/04/27 13:23:35 ERROR datasources.FileFormatWriter: Aborting job fba833f1-dea5-4528-b8fc-789bf94011bb.
org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 58.0 failed 1 times, most recent failure: Lost task 0.0 in stage 58.0 (TID 654) (0.0.0.0 executor driver): java.io.FileNotFoundException: File does not exist: hdfs://master:9000/datalake/silver/currencies/RUB_EUR/rate_month=4/part-00017-af47337b-61d2-4ad1-9aa4-dd838553b208.c000.snappy.parquet
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:169)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:503)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:225)
	at org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2253)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2202)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2201)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2201)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1078)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1078)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1078)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2440)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2382)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2371)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:868)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2202)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:200)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:188)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:108)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:106)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:131)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:180)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:218)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:215)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:176)
	at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:132)
	at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:131)
	at org.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:989)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:989)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:438)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:415)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:293)
	at org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:874)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.FileNotFoundException: File does not exist: hdfs://master:9000/datalake/silver/currencies/RUB_EUR/rate_month=4/part-00017-af47337b-61d2-4ad1-9aa4-dd838553b208.c000.snappy.parquet
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:169)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:503)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:225)
	at org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
22/04/27 13:25:14 ERROR executor.Executor: Exception in task 0.0 in stage 59.0 (TID 655)
java.io.FileNotFoundException: File does not exist: hdfs://master:9000/datalake/silver/currencies/RUB_EUR/rate_month=4/part-00017-af47337b-61d2-4ad1-9aa4-dd838553b208.c000.snappy.parquet
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:169)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:503)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:225)
	at org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
22/04/27 13:25:14 WARN scheduler.TaskSetManager: Lost task 0.0 in stage 59.0 (TID 655) (0.0.0.0 executor driver): java.io.FileNotFoundException: File does not exist: hdfs://master:9000/datalake/silver/currencies/RUB_EUR/rate_month=4/part-00017-af47337b-61d2-4ad1-9aa4-dd838553b208.c000.snappy.parquet
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:169)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:503)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:225)
	at org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

22/04/27 13:25:14 ERROR scheduler.TaskSetManager: Task 0 in stage 59.0 failed 1 times; aborting job
22/04/27 13:25:14 ERROR datasources.FileFormatWriter: Aborting job fa410bd5-2810-48ae-88d4-a23b47d1d201.
org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 59.0 failed 1 times, most recent failure: Lost task 0.0 in stage 59.0 (TID 655) (0.0.0.0 executor driver): java.io.FileNotFoundException: File does not exist: hdfs://master:9000/datalake/silver/currencies/RUB_EUR/rate_month=4/part-00017-af47337b-61d2-4ad1-9aa4-dd838553b208.c000.snappy.parquet
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:169)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:503)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:225)
	at org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2253)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2202)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2201)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2201)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1078)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1078)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1078)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2440)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2382)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2371)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:868)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2202)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:200)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:188)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:108)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:106)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:131)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:180)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:218)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:215)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:176)
	at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:132)
	at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:131)
	at org.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:989)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:989)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:438)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:415)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:293)
	at org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:874)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.FileNotFoundException: File does not exist: hdfs://master:9000/datalake/silver/currencies/RUB_EUR/rate_month=4/part-00017-af47337b-61d2-4ad1-9aa4-dd838553b208.c000.snappy.parquet
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:169)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:503)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:225)
	at org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 13:25:24.432 NotebookApp] Saving file at /Test.ipynb
22/04/27 13:25:39 ERROR executor.Executor: Exception in task 0.0 in stage 60.0 (TID 656)
java.io.FileNotFoundException: File does not exist: hdfs://master:9000/datalake/silver/currencies/RUB_EUR/rate_month=4/part-00017-af47337b-61d2-4ad1-9aa4-dd838553b208.c000.snappy.parquet
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:169)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:503)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:225)
	at org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
22/04/27 13:25:39 WARN scheduler.TaskSetManager: Lost task 0.0 in stage 60.0 (TID 656) (0.0.0.0 executor driver): java.io.FileNotFoundException: File does not exist: hdfs://master:9000/datalake/silver/currencies/RUB_EUR/rate_month=4/part-00017-af47337b-61d2-4ad1-9aa4-dd838553b208.c000.snappy.parquet
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:169)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:503)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:225)
	at org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

22/04/27 13:25:39 ERROR scheduler.TaskSetManager: Task 0 in stage 60.0 failed 1 times; aborting job
22/04/27 13:25:39 ERROR datasources.FileFormatWriter: Aborting job 68b840fe-79f5-4d63-8d9a-8a7b655bbc2d.
org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 60.0 failed 1 times, most recent failure: Lost task 0.0 in stage 60.0 (TID 656) (0.0.0.0 executor driver): java.io.FileNotFoundException: File does not exist: hdfs://master:9000/datalake/silver/currencies/RUB_EUR/rate_month=4/part-00017-af47337b-61d2-4ad1-9aa4-dd838553b208.c000.snappy.parquet
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:169)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:503)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:225)
	at org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2253)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2202)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2201)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2201)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1078)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1078)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1078)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2440)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2382)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2371)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:868)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2202)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:200)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:188)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:108)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:106)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:131)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:180)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:218)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:215)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:176)
	at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:132)
	at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:131)
	at org.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:989)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:989)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:438)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:415)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:293)
	at org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:874)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.FileNotFoundException: File does not exist: hdfs://master:9000/datalake/silver/currencies/RUB_EUR/rate_month=4/part-00017-af47337b-61d2-4ad1-9aa4-dd838553b208.c000.snappy.parquet
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:169)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:503)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)
	at org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:225)
	at org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 13:27:24.379 NotebookApp] Saving file at /Test.ipynb
[I 13:31:24.265 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 13:33:25.035 NotebookApp] Saving file at /Test.ipynb
[I 13:41:25.194 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 13:43:24.302 NotebookApp] Saving file at /Test.ipynb
[I 13:45:24.245 NotebookApp] Saving file at /Test.ipynb
[I 13:47:25.017 NotebookApp] Saving file at /Test.ipynb
[I 14:35:23.934 NotebookApp] Saving file at /Test.ipynb
[Stage 80:>                                                       (0 + 1) / 200][Stage 80:==>                                                     (9 + 1) / 200][Stage 80:====>                                                  (18 + 1) / 200][Stage 80:========>                                              (32 + 1) / 200][Stage 80:============>                                          (44 + 2) / 200][Stage 80:==============>                                        (52 + 1) / 200][Stage 80:=================>                                     (65 + 1) / 200][Stage 80:=====================>                                 (77 + 1) / 200][Stage 80:=======================>                               (85 + 1) / 200][Stage 80:==========================>                            (97 + 1) / 200][Stage 80:=============================>                        (110 + 1) / 200][Stage 80:================================>                     (120 + 1) / 200][Stage 80:==================================>                   (128 + 1) / 200][Stage 80:======================================>               (142 + 1) / 200][Stage 80:==========================================>           (158 + 1) / 200][Stage 80:=============================================>        (169 + 1) / 200][Stage 80:================================================>     (181 + 1) / 200][Stage 80:===================================================>  (191 + 1) / 200][Stage 80:=====================================================>(197 + 1) / 200]                                                                                [IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 14:37:23.855 NotebookApp] Saving file at /Test.ipynb
[I 14:39:23.799 NotebookApp] Saving file at /Test.ipynb
22/04/27 17:01:38 WARN spark.HeartbeatReceiver: Removing executor driver with no recent heartbeats: 369119 ms exceeds timeout 120000 ms
22/04/27 17:01:38 WARN spark.SparkContext: Killing executors is not supported by current scheduler.
[I 17:01:39.137 NotebookApp] Saving file at /Test.ipynb
[W 19:33:42.379 NotebookApp] Replacing stale connection: ef3e8642-8ce6-420a-a8c7-337787a168bf:a97b775235824fe79bf8b180090b5141
[I 19:33:47.393 NotebookApp] Starting buffering for ef3e8642-8ce6-420a-a8c7-337787a168bf:a97b775235824fe79bf8b180090b5141
[I 19:33:47.416 NotebookApp] Restoring connection for ef3e8642-8ce6-420a-a8c7-337787a168bf:a97b775235824fe79bf8b180090b5141
[W 19:36:17.418 NotebookApp] WebSocket ping timeout after 119998 ms.
[I 19:36:22.433 NotebookApp] Starting buffering for ef3e8642-8ce6-420a-a8c7-337787a168bf:a97b775235824fe79bf8b180090b5141
[W 19:36:30.377 NotebookApp] WebSocket ping timeout after 119999 ms.
[W 19:36:31.694 NotebookApp] WebSocket ping timeout after 119998 ms.
[I 19:36:35.378 NotebookApp] Starting buffering for dde176cf-8deb-4ab8-acab-172808121c73:3cbb6074609e4b7c91ada8549b1875cb
[I 19:36:36.698 NotebookApp] Starting buffering for 8f378dcf-b7eb-4949-a252-29df27c582ad:878fd477e51447c38bb2ad15aef83437
[W 00:49:47.798 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 00:49:47.804 NotebookApp] The port 8888 is already in use, trying another port.
[I 00:49:47.804 NotebookApp] The port 8889 is already in use, trying another port.
[I 00:49:47.805 NotebookApp] The port 8890 is already in use, trying another port.
[I 00:49:47.805 NotebookApp] The port 8891 is already in use, trying another port.
[I 00:49:47.806 NotebookApp] Serving notebooks from local directory: /home/user/spark_code
[I 00:49:47.806 NotebookApp] Jupyter Notebook 6.4.8 is running at:
[I 00:49:47.806 NotebookApp] http://server:8892/?token=10a909a42441443c2c48f13b4867c13761848b1d207aad9d
[I 00:49:47.806 NotebookApp]  or http://127.0.0.1:8892/?token=10a909a42441443c2c48f13b4867c13761848b1d207aad9d
[I 00:49:47.806 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 00:49:47.812 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///home/user/.local/share/jupyter/runtime/nbserver-17529-open.html
    Or copy and paste one of these URLs:
        http://server:8892/?token=10a909a42441443c2c48f13b4867c13761848b1d207aad9d
     or http://127.0.0.1:8892/?token=10a909a42441443c2c48f13b4867c13761848b1d207aad9d
[I 00:50:10.124 NotebookApp] 302 GET /?token=10a909a42441443c2c48f13b4867c13761848b1d207aad9d (192.168.0.15) 0.470000ms
[W 00:50:20.565 NotebookApp] Notebook Test.ipynb is not trusted
[I 00:50:21.083 NotebookApp] Kernel started: ab2a31fe-0a88-4ebf-91b5-2227480f124c, name: python3
[I 00:50:27.950 NotebookApp] Starting buffering for ab2a31fe-0a88-4ebf-91b5-2227480f124c:0c0dd76b665d4209a3c1c569e7fecd28
[I 00:50:28.188 NotebookApp] Kernel restarted: ab2a31fe-0a88-4ebf-91b5-2227480f124c
[I 00:50:28.197 NotebookApp] Restoring connection for ab2a31fe-0a88-4ebf-91b5-2227480f124c:0c0dd76b665d4209a3c1c569e7fecd28
[I 00:50:29.202 NotebookApp] Replaying 3 buffered messages
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
22/04/28 00:50:34 WARN util.Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
22/04/28 00:50:34 WARN util.Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
22/04/28 00:50:34 WARN util.Utils: Service 'SparkUI' could not bind on port 4042. Attempting port 4043.
22/04/28 00:50:34 WARN util.Utils: Service 'SparkUI' could not bind on port 4043. Attempting port 4044.
22/04/28 00:50:34 WARN util.Utils: Service 'SparkUI' could not bind on port 4044. Attempting port 4045.
22/04/28 00:50:34 WARN util.Utils: Service 'SparkUI' could not bind on port 4045. Attempting port 4046.
22/04/28 00:50:34 WARN util.Utils: Service 'SparkUI' could not bind on port 4046. Attempting port 4047.
[I 00:52:21.008 NotebookApp] Saving file at /Test.ipynb
[I 00:54:21.175 NotebookApp] Saving file at /Test.ipynb
[Stage 0:>                                                          (0 + 1) / 1]22/04/28 00:56:06 WARN csv.CSVHeaderChecker: CSV header does not conform to the schema.
 Header: order_id, product_id, client_id, store_id, quantity, order_date
 Schema: order_id, product_id, client_id, store_id, order_date, quantity
Expected: order_date but found: quantity
CSV file: hdfs://master:9000/datalake/bronze/dshop_bu/orders/2022-04-27/orders.csv
                                                                                [I 00:56:21.126 NotebookApp] Saving file at /Test.ipynb
[I 01:04:20.999 NotebookApp] Saving file at /Test.ipynb
[Stage 3:>                                                          (0 + 1) / 4][Stage 3:==============>                                            (1 + 1) / 4][I 01:06:20.934 NotebookApp] Saving file at /Test.ipynb
[Stage 3:=============================>                             (2 + 1) / 4][Stage 3:============================================>              (3 + 1) / 4][Stage 4:===>                                                    (12 + 1) / 200][Stage 4:=====>                                                  (18 + 1) / 200][Stage 4:======>                                                 (24 + 1) / 200][Stage 4:========>                                               (30 + 1) / 200][Stage 4:==========>                                             (36 + 1) / 200][Stage 4:============>                                           (43 + 1) / 200][Stage 4:=============>                                          (49 + 1) / 200][Stage 4:===============>                                        (56 + 2) / 200][Stage 4:=================>                                      (63 + 1) / 200][Stage 4:===================>                                    (70 + 1) / 200][Stage 4:=====================>                                  (77 + 1) / 200][Stage 4:=======================>                                (84 + 1) / 200][Stage 4:=========================>                              (92 + 1) / 200][Stage 4:===========================>                            (98 + 1) / 200][Stage 4:=============================>                         (106 + 1) / 200][Stage 4:===============================>                       (113 + 1) / 200][Stage 4:=================================>                     (121 + 1) / 200][Stage 4:===================================>                   (128 + 1) / 200][Stage 4:====================================>                  (133 + 1) / 200][Stage 4:======================================>                (141 + 1) / 200][Stage 4:========================================>              (148 + 1) / 200][Stage 4:==========================================>            (156 + 1) / 200][Stage 4:============================================>          (163 + 1) / 200][Stage 4:==============================================>        (170 + 1) / 200][Stage 4:================================================>      (177 + 1) / 200][Stage 4:==================================================>    (184 + 1) / 200][Stage 4:====================================================>  (191 + 1) / 200][Stage 4:======================================================>(199 + 1) / 200]                                                                                [Stage 15:>                                                         (0 + 1) / 4][Stage 15:==============>                                           (1 + 1) / 4][Stage 15:=============================>                            (2 + 1) / 4][Stage 15:===========================================>              (3 + 1) / 4]                                                                                [I 01:08:20.923 NotebookApp] Saving file at /Test.ipynb
[I 01:10:21.101 NotebookApp] Saving file at /Test.ipynb
[Stage 17:>                                                         (0 + 1) / 4][Stage 17:==============>                                           (1 + 1) / 4][Stage 17:=============================>                            (2 + 1) / 4][Stage 17:===========================================>              (3 + 1) / 4][Stage 18:>                                                       (0 + 1) / 200][Stage 18:>                                                       (1 + 1) / 200][Stage 18:>                                                       (2 + 1) / 200][Stage 18:>                                                       (3 + 1) / 200][Stage 18:=>                                                      (4 + 1) / 200][Stage 18:=>                                                      (5 + 1) / 200][Stage 18:=>                                                      (7 + 1) / 200][Stage 18:==>                                                     (8 + 1) / 200][Stage 18:==>                                                     (9 + 1) / 200][Stage 18:===>                                                   (11 + 1) / 200][Stage 18:===>                                                   (13 + 1) / 200][Stage 18:====>                                                  (15 + 1) / 200][Stage 18:====>                                                  (16 + 1) / 200][Stage 18:====>                                                  (17 + 1) / 200][Stage 18:=====>                                                 (19 + 1) / 200][Stage 18:=====>                                                 (21 + 1) / 200][Stage 18:======>                                                (23 + 1) / 200][Stage 18:======>                                                (24 + 1) / 200][Stage 18:=======>                                               (26 + 1) / 200][Stage 18:=======>                                               (28 + 1) / 200][Stage 18:=======>                                               (29 + 1) / 200][Stage 18:========>                                              (30 + 1) / 200][Stage 18:========>                                              (31 + 1) / 200][Stage 18:=========>                                             (34 + 1) / 200][Stage 18:=========>                                             (35 + 1) / 200][Stage 18:=========>                                             (36 + 1) / 200][Stage 18:==========>                                            (38 + 1) / 200][Stage 18:==========>                                            (39 + 1) / 200][Stage 18:===========>                                           (40 + 1) / 200][Stage 18:===========>                                           (41 + 1) / 200][Stage 18:============>                                          (44 + 1) / 200][Stage 18:============>                                          (46 + 1) / 200][Stage 18:============>                                          (47 + 1) / 200][Stage 18:=============>                                         (49 + 1) / 200][Stage 18:==============>                                        (51 + 1) / 200][Stage 18:==============>                                        (53 + 1) / 200][Stage 18:==============>                                        (54 + 1) / 200][Stage 18:===============>                                       (55 + 1) / 200][Stage 18:===============>                                       (56 + 1) / 200][Stage 18:===============>                                       (57 + 1) / 200][Stage 18:===============>                                       (58 + 1) / 200][Stage 18:================>                                      (59 + 1) / 200][Stage 18:================>                                      (61 + 1) / 200][Stage 18:=================>                                     (63 + 1) / 200][Stage 18:=================>                                     (65 + 1) / 200][Stage 18:==================>                                    (67 + 1) / 200][Stage 18:==================>                                    (68 + 1) / 200][Stage 18:==================>                                    (69 + 1) / 200][Stage 18:===================>                                   (70 + 1) / 200][Stage 18:===================>                                   (71 + 1) / 200][Stage 18:===================>                                   (72 + 1) / 200][Stage 18:====================>                                  (74 + 1) / 200][Stage 18:====================>                                  (76 + 1) / 200][Stage 18:=====================>                                 (79 + 1) / 200][Stage 18:======================>                                (81 + 1) / 200][Stage 18:======================>                                (82 + 1) / 200][Stage 18:======================>                                (83 + 1) / 200][Stage 18:=======================>                               (84 + 1) / 200][Stage 18:=======================>                               (85 + 1) / 200][Stage 18:=======================>                               (86 + 1) / 200][Stage 18:========================>                              (88 + 1) / 200][Stage 18:========================>                              (89 + 1) / 200][Stage 18:========================>                              (90 + 1) / 200][Stage 18:=========================>                             (91 + 1) / 200][Stage 18:=========================>                             (92 + 1) / 200][Stage 18:=========================>                             (93 + 1) / 200][Stage 18:==========================>                            (95 + 1) / 200][Stage 18:==========================>                            (96 + 1) / 200][Stage 18:==========================>                            (97 + 1) / 200][Stage 18:===========================>                           (99 + 1) / 200][Stage 18:===========================>                          (100 + 1) / 200][Stage 18:===========================>                          (101 + 1) / 200][Stage 18:===========================>                          (102 + 1) / 200][I 01:12:21.152 NotebookApp] Saving file at /Test.ipynb
[Stage 18:===========================>                          (103 + 1) / 200][Stage 18:============================>                         (104 + 1) / 200][Stage 18:============================>                         (105 + 1) / 200][Stage 18:============================>                         (106 + 1) / 200][Stage 18:============================>                         (107 + 1) / 200][Stage 18:=============================>                        (110 + 1) / 200][Stage 18:==============================>                       (112 + 1) / 200][Stage 18:==============================>                       (114 + 1) / 200][Stage 18:===============================>                      (115 + 1) / 200][Stage 18:===============================>                      (116 + 1) / 200][Stage 18:===============================>                      (117 + 1) / 200][Stage 18:===============================>                      (118 + 1) / 200][Stage 18:================================>                     (119 + 1) / 200][Stage 18:================================>                     (120 + 1) / 200][Stage 18:================================>                     (121 + 1) / 200][Stage 18:=================================>                    (124 + 1) / 200][Stage 18:==================================>                   (126 + 1) / 200][Stage 18:==================================>                   (128 + 1) / 200][Stage 18:==================================>                   (129 + 1) / 200][Stage 18:===================================>                  (130 + 1) / 200][Stage 18:===================================>                  (131 + 1) / 200][Stage 18:===================================>                  (132 + 1) / 200][Stage 18:===================================>                  (133 + 1) / 200][Stage 18:====================================>                 (134 + 1) / 200][Stage 18:====================================>                 (135 + 1) / 200][Stage 18:====================================>                 (136 + 1) / 200][Stage 18:====================================>                 (137 + 1) / 200][Stage 18:=====================================>                (139 + 1) / 200][Stage 18:======================================>               (141 + 1) / 200][Stage 18:======================================>               (142 + 1) / 200][Stage 18:======================================>               (143 + 1) / 200][Stage 18:======================================>               (144 + 1) / 200][Stage 18:=======================================>              (146 + 1) / 200][Stage 18:=======================================>              (147 + 1) / 200][Stage 18:=======================================>              (148 + 1) / 200][Stage 18:========================================>             (149 + 1) / 200][Stage 18:========================================>             (150 + 1) / 200][Stage 18:========================================>             (151 + 1) / 200][Stage 18:=========================================>            (152 + 1) / 200][Stage 18:=========================================>            (154 + 1) / 200][Stage 18:==========================================>           (157 + 1) / 200][Stage 18:==========================================>           (158 + 1) / 200][Stage 18:==========================================>           (159 + 1) / 200][Stage 18:===========================================>          (161 + 1) / 200][Stage 18:===========================================>          (162 + 1) / 200][Stage 18:============================================>         (163 + 1) / 200][Stage 18:============================================>         (165 + 1) / 200][Stage 18:============================================>         (166 + 1) / 200][Stage 18:=============================================>        (167 + 1) / 200][Stage 18:=============================================>        (168 + 1) / 200][Stage 18:=============================================>        (169 + 1) / 200][Stage 18:=============================================>        (170 + 1) / 200][Stage 18:==============================================>       (171 + 1) / 200][Stage 18:==============================================>       (172 + 1) / 200][Stage 18:==============================================>       (173 + 1) / 200][Stage 18:==============================================>       (174 + 1) / 200][Stage 18:===============================================>      (175 + 1) / 200][Stage 18:===============================================>      (176 + 1) / 200][Stage 18:===============================================>      (177 + 1) / 200][Stage 18:================================================>     (178 + 1) / 200][Stage 18:================================================>     (179 + 1) / 200][Stage 18:================================================>     (180 + 1) / 200][Stage 18:================================================>     (181 + 1) / 200][Stage 18:=================================================>    (182 + 1) / 200][Stage 18:=================================================>    (183 + 1) / 200][Stage 18:=================================================>    (185 + 1) / 200][Stage 18:==================================================>   (186 + 1) / 200][Stage 18:==================================================>   (187 + 1) / 200][Stage 18:==================================================>   (188 + 1) / 200][Stage 18:===================================================>  (190 + 1) / 200][Stage 18:===================================================>  (191 + 1) / 200][Stage 18:===================================================>  (192 + 2) / 200][Stage 18:====================================================> (195 + 1) / 200][Stage 18:=====================================================>(197 + 1) / 200][Stage 18:=====================================================>(198 + 1) / 200][Stage 18:=====================================================>(199 + 1) / 200]                                                                                [Stage 19:>                                                         (0 + 1) / 4][Stage 19:==============>                                           (1 + 1) / 4][Stage 19:=============================>                            (2 + 1) / 4][Stage 19:===========================================>              (3 + 1) / 4][Stage 20:===>                                                   (13 + 1) / 200][Stage 20:====>                                                  (16 + 1) / 200][Stage 20:=====>                                                 (21 + 1) / 200][Stage 20:======>                                                (24 + 1) / 200][Stage 20:=======>                                               (28 + 1) / 200][Stage 20:=========>                                             (33 + 1) / 200][Stage 20:==========>                                            (39 + 1) / 200][Stage 20:============>                                          (44 + 1) / 200][Stage 20:============>                                          (47 + 1) / 200][Stage 20:==============>                                        (52 + 1) / 200][Stage 20:================>                                      (59 + 1) / 200][Stage 20:=================>                                     (64 + 1) / 200][Stage 20:===================>                                   (72 + 1) / 200][Stage 20:=====================>                                 (79 + 1) / 200][Stage 20:=======================>                               (85 + 1) / 200][Stage 20:=========================>                             (93 + 1) / 200][I 01:14:21.106 NotebookApp] Saving file at /Test.ipynb
[Stage 20:===========================>                          (100 + 2) / 200][Stage 20:=============================>                        (108 + 1) / 200][Stage 20:===============================>                      (116 + 1) / 200][Stage 20:=================================>                    (124 + 1) / 200][Stage 20:===================================>                  (131 + 1) / 200][Stage 20:=====================================>                (139 + 1) / 200][Stage 20:=======================================>              (147 + 1) / 200][Stage 20:=========================================>            (154 + 1) / 200][Stage 20:===========================================>          (161 + 1) / 200][Stage 20:=============================================>        (167 + 1) / 200][Stage 20:==============================================>       (172 + 1) / 200][Stage 20:================================================>     (179 + 1) / 200][Stage 20:==================================================>   (186 + 1) / 200][Stage 20:====================================================> (193 + 1) / 200][Stage 20:=====================================================>(199 + 1) / 200][Stage 21:>                                                       (2 + 1) / 200][Stage 21:>                                                       (3 + 1) / 200][Stage 21:=>                                                      (7 + 1) / 200][Stage 21:==>                                                     (8 + 1) / 200][Stage 21:===>                                                   (11 + 1) / 200][Stage 21:===>                                                   (12 + 1) / 200][Stage 21:====>                                                  (16 + 1) / 200][Stage 21:=====>                                                 (19 + 1) / 200][Stage 21:=====>                                                 (20 + 1) / 200][Stage 21:======>                                                (22 + 1) / 200][Stage 21:======>                                                (23 + 1) / 200][Stage 21:======>                                                (24 + 1) / 200][Stage 21:======>                                                (25 + 1) / 200][Stage 21:=======>                                               (26 + 1) / 200][Stage 21:=======>                                               (28 + 1) / 200][Stage 21:=======>                                               (29 + 1) / 200][Stage 21:========>                                              (31 + 1) / 200][Stage 21:=========>                                             (33 + 1) / 200][Stage 21:=========>                                             (34 + 1) / 200][Stage 21:=========>                                             (36 + 1) / 200][Stage 21:===========>                                           (40 + 1) / 200][Stage 21:============>                                          (44 + 1) / 200][Stage 21:============>                                          (45 + 1) / 200][Stage 21:============>                                          (46 + 1) / 200][Stage 21:============>                                          (47 + 1) / 200][Stage 21:=============>                                         (48 + 1) / 200][Stage 21:=============>                                         (49 + 1) / 200][Stage 21:=============>                                         (50 + 1) / 200][Stage 21:==============>                                        (51 + 1) / 200][Stage 21:==============>                                        (52 + 1) / 200][Stage 21:===============>                                       (56 + 1) / 200][Stage 21:===============>                                       (58 + 1) / 200][Stage 21:================>                                      (61 + 1) / 200][Stage 21:=================>                                     (64 + 1) / 200][Stage 21:==================>                                    (67 + 1) / 200][Stage 21:=====================>                                 (77 + 1) / 200][Stage 21:======================>                                (81 + 1) / 200][Stage 21:========================>                              (88 + 1) / 200][Stage 21:==============================>                       (113 + 1) / 200][Stage 21:====================================>                 (135 + 1) / 200][Stage 21:============================================>         (163 + 1) / 200][Stage 21:=================================================>    (184 + 1) / 200]                                                                                [I 01:15:22.472 NotebookApp] Saving file at /Test.ipynb
22/04/28 10:14:39 WARN spark.HeartbeatReceiver: Removing executor driver with no recent heartbeats: 32014721 ms exceeds timeout 120000 ms
[W 10:14:40.319 NotebookApp] Replacing stale connection: ab2a31fe-0a88-4ebf-91b5-2227480f124c:0c0dd76b665d4209a3c1c569e7fecd28
22/04/28 10:14:42 WARN spark.SparkContext: Killing executors is not supported by current scheduler.
[W 10:14:42.677 NotebookApp] zmq message arrived on closed channel
[I 10:14:45.324 NotebookApp] Starting buffering for ab2a31fe-0a88-4ebf-91b5-2227480f124c:0c0dd76b665d4209a3c1c569e7fecd28
[I 10:14:45.325 NotebookApp] Restoring connection for ab2a31fe-0a88-4ebf-91b5-2227480f124c:0c0dd76b665d4209a3c1c569e7fecd28
[W 11:13:09.114 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 11:13:09.116 NotebookApp] The port 8888 is already in use, trying another port.
[I 11:13:09.116 NotebookApp] The port 8889 is already in use, trying another port.
[I 11:13:09.116 NotebookApp] The port 8890 is already in use, trying another port.
[I 11:13:09.117 NotebookApp] The port 8891 is already in use, trying another port.
[I 11:13:09.117 NotebookApp] The port 8892 is already in use, trying another port.
[I 11:13:09.117 NotebookApp] Serving notebooks from local directory: /home/user/spark_code
[I 11:13:09.117 NotebookApp] Jupyter Notebook 6.4.8 is running at:
[I 11:13:09.117 NotebookApp] http://server:8859/?token=0be386fb3e8f300d0e12fcfc01b506764cfb9a0093bcb4de
[I 11:13:09.117 NotebookApp]  or http://127.0.0.1:8859/?token=0be386fb3e8f300d0e12fcfc01b506764cfb9a0093bcb4de
[I 11:13:09.117 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 11:13:09.119 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///home/user/.local/share/jupyter/runtime/nbserver-6117-open.html
    Or copy and paste one of these URLs:
        http://server:8859/?token=0be386fb3e8f300d0e12fcfc01b506764cfb9a0093bcb4de
     or http://127.0.0.1:8859/?token=0be386fb3e8f300d0e12fcfc01b506764cfb9a0093bcb4de
[I 11:13:29.262 NotebookApp] Starting buffering for ab2a31fe-0a88-4ebf-91b5-2227480f124c:0c0dd76b665d4209a3c1c569e7fecd28
[I 11:13:34.658 NotebookApp] 302 GET /?token=0be386fb3e8f300d0e12fcfc01b506764cfb9a0093bcb4de (192.168.0.15) 0.400000ms
[W 11:13:39.427 NotebookApp] Notebook Test.ipynb is not trusted
[I 11:13:39.968 NotebookApp] Kernel started: aaa498c4-fb6d-402d-aea0-005e745e910e, name: python3
[I 11:13:43.758 NotebookApp] Starting buffering for aaa498c4-fb6d-402d-aea0-005e745e910e:caf8043eb0944163855f0efb49faa835
[I 11:13:43.993 NotebookApp] Kernel restarted: aaa498c4-fb6d-402d-aea0-005e745e910e
[I 11:13:44.002 NotebookApp] Restoring connection for aaa498c4-fb6d-402d-aea0-005e745e910e:caf8043eb0944163855f0efb49faa835
[I 11:13:44.433 NotebookApp] Replaying 3 buffered messages
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
22/04/28 11:13:48 WARN util.Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
22/04/28 11:13:48 WARN util.Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
22/04/28 11:13:48 WARN util.Utils: Service 'SparkUI' could not bind on port 4042. Attempting port 4043.
22/04/28 11:13:48 WARN util.Utils: Service 'SparkUI' could not bind on port 4043. Attempting port 4044.
22/04/28 11:13:48 WARN util.Utils: Service 'SparkUI' could not bind on port 4044. Attempting port 4045.
22/04/28 11:13:48 WARN util.Utils: Service 'SparkUI' could not bind on port 4045. Attempting port 4046.
22/04/28 11:13:48 WARN util.Utils: Service 'SparkUI' could not bind on port 4046. Attempting port 4047.
[I 11:15:39.968 NotebookApp] Saving file at /Test.ipynb
[Stage 2:===>                                                      (1 + 1) / 19][Stage 2:======>                                                   (2 + 1) / 19][Stage 2:=========>                                                (3 + 1) / 19][Stage 2:============>                                             (4 + 1) / 19][Stage 2:===============>                                          (5 + 1) / 19][Stage 2:==================>                                       (6 + 1) / 19][Stage 2:=====================>                                    (7 + 1) / 19][Stage 2:========================>                                 (8 + 1) / 19][Stage 2:===========================>                              (9 + 1) / 19][Stage 2:==============================>                          (10 + 1) / 19][Stage 2:=================================>                       (11 + 1) / 19][Stage 2:====================================>                    (12 + 1) / 19][Stage 2:=======================================>                 (13 + 1) / 19][Stage 2:==========================================>              (14 + 1) / 19][Stage 2:=============================================>           (15 + 1) / 19][Stage 2:================================================>        (16 + 1) / 19][Stage 2:===================================================>     (17 + 1) / 19]                                                                                [Stage 5:===>                                                      (1 + 1) / 19][Stage 5:======>                                                   (2 + 1) / 19][Stage 5:=========>                                                (3 + 1) / 19][Stage 5:============>                                             (4 + 1) / 19][Stage 5:===============>                                          (5 + 1) / 19][Stage 5:=====================>                                    (7 + 1) / 19][Stage 5:========================>                                 (8 + 1) / 19][Stage 5:===========================>                              (9 + 1) / 19][Stage 5:==============================>                          (10 + 1) / 19][Stage 5:=================================>                       (11 + 1) / 19][Stage 5:=======================================>                 (13 + 1) / 19][Stage 5:==========================================>              (14 + 1) / 19][Stage 5:=============================================>           (15 + 1) / 19][Stage 5:===================================================>     (17 + 1) / 19][Stage 5:======================================================>  (18 + 1) / 19]                                                                                [I 11:17:40.545 NotebookApp] Saving file at /Test.ipynb
[I 11:19:40.076 NotebookApp] Saving file at /Test.ipynb
[Stage 14:========================>                              (89 + 1) / 200][Stage 14:=============================>                        (111 + 1) / 200][Stage 14:========================================>             (149 + 1) / 200][Stage 14:==============================================>       (173 + 1) / 200]                                                                                [I 11:21:40.136 NotebookApp] Saving file at /Test.ipynb
[Stage 22:============================>                         (105 + 1) / 200][Stage 22:=======================================>              (147 + 1) / 200][Stage 22:===================================================>  (189 + 1) / 200]                                                                                [I 11:23:40.197 NotebookApp] Saving file at /Test.ipynb
[Stage 24:>                                                       (2 + 1) / 505][Stage 24:>                                                       (3 + 1) / 505][Stage 24:>                                                       (4 + 1) / 505][Stage 24:>                                                       (5 + 1) / 505][Stage 24:>                                                       (7 + 1) / 505][Stage 24:>                                                       (8 + 1) / 505][Stage 24:>                                                       (9 + 1) / 505][Stage 24:=>                                                     (11 + 1) / 505][Stage 24:=>                                                     (12 + 1) / 505][Stage 24:=>                                                     (14 + 1) / 505][Stage 24:=>                                                     (15 + 1) / 505][Stage 24:=>                                                     (17 + 1) / 505][Stage 24:=>                                                     (18 + 1) / 505][Stage 24:==>                                                    (19 + 1) / 505][Stage 24:==>                                                    (20 + 1) / 505][Stage 24:==>                                                    (22 + 1) / 505][Stage 24:==>                                                    (24 + 1) / 505][Stage 24:==>                                                    (25 + 1) / 505][Stage 24:==>                                                    (27 + 1) / 505][Stage 24:===>                                                   (28 + 1) / 505][Stage 24:===>                                                   (29 + 1) / 505][Stage 24:===>                                                   (31 + 1) / 505][Stage 24:===>                                                   (32 + 1) / 505][Stage 24:===>                                                   (33 + 1) / 505][Stage 24:===>                                                   (35 + 1) / 505][Stage 24:===>                                                   (36 + 1) / 505][Stage 24:====>                                                  (37 + 1) / 505][Stage 24:====>                                                  (39 + 1) / 505][Stage 24:====>                                                  (41 + 1) / 505][Stage 24:====>                                                  (42 + 1) / 505][Stage 24:====>                                                  (44 + 1) / 505][Stage 24:====>                                                  (45 + 1) / 505][Stage 24:=====>                                                 (46 + 1) / 505][Stage 24:=====>                                                 (48 + 1) / 505][Stage 24:=====>                                                 (50 + 1) / 505][Stage 24:=====>                                                 (52 + 1) / 505][Stage 24:=====>                                                 (53 + 1) / 505][Stage 24:=====>                                                 (54 + 1) / 505][Stage 24:======>                                                (56 + 1) / 505][Stage 24:======>                                                (58 + 1) / 505][Stage 24:======>                                                (60 + 1) / 505][Stage 24:======>                                                (61 + 1) / 505][Stage 24:======>                                                (62 + 1) / 505][Stage 24:======>                                                (63 + 1) / 505][Stage 24:=======>                                               (65 + 1) / 505][Stage 24:=======>                                               (66 + 1) / 505][Stage 24:=======>                                               (67 + 1) / 505][Stage 24:=======>                                               (69 + 1) / 505][Stage 24:=======>                                               (70 + 1) / 505][Stage 24:=======>                                               (72 + 1) / 505][Stage 24:========>                                              (74 + 1) / 505][Stage 24:========>                                              (75 + 1) / 505][Stage 24:========>                                              (77 + 1) / 505][Stage 24:========>                                              (79 + 1) / 505][Stage 24:========>                                              (80 + 1) / 505][Stage 24:========>                                              (82 + 1) / 505][Stage 24:=========>                                             (85 + 1) / 505][Stage 24:=========>                                             (86 + 1) / 505][Stage 24:=========>                                             (88 + 1) / 505][Stage 24:=========>                                             (90 + 1) / 505][Stage 24:==========>                                            (92 + 1) / 505][Stage 24:==========>                                            (94 + 1) / 505][Stage 24:==========>                                            (95 + 1) / 505][Stage 24:==========>                                            (96 + 1) / 505][Stage 24:==========>                                            (98 + 1) / 505][Stage 24:==========>                                            (99 + 1) / 505][Stage 24:==========>                                           (101 + 1) / 505][Stage 24:==========>                                           (102 + 1) / 505][Stage 24:===========>                                          (104 + 1) / 505][Stage 24:===========>                                          (105 + 1) / 505][Stage 24:===========>                                          (106 + 1) / 505][Stage 24:===========>                                          (108 + 1) / 505][Stage 24:===========>                                          (109 + 1) / 505][Stage 24:===========>                                          (111 + 1) / 505][Stage 24:===========>                                          (112 + 1) / 505][Stage 24:============>                                         (113 + 1) / 505][Stage 24:============>                                         (114 + 1) / 505][Stage 24:============>                                         (115 + 1) / 505][Stage 24:============>                                         (116 + 1) / 505][Stage 24:============>                                         (117 + 1) / 505][Stage 24:============>                                         (118 + 1) / 505][Stage 24:============>                                         (120 + 1) / 505][Stage 24:============>                                         (121 + 1) / 505][Stage 24:=============>                                        (122 + 1) / 505][Stage 24:=============>                                        (123 + 1) / 505][Stage 24:=============>                                        (124 + 1) / 505][Stage 24:=============>                                        (125 + 1) / 505][Stage 24:=============>                                        (127 + 1) / 505][Stage 24:=============>                                        (128 + 1) / 505][Stage 24:=============>                                        (129 + 1) / 505][Stage 24:=============>                                        (130 + 1) / 505][Stage 24:==============>                                       (131 + 1) / 505][Stage 24:==============>                                       (133 + 1) / 505][Stage 24:==============>                                       (134 + 1) / 505][Stage 24:==============>                                       (135 + 1) / 505][Stage 24:==============>                                       (136 + 1) / 505][Stage 24:==============>                                       (137 + 1) / 505][Stage 24:==============>                                       (139 + 1) / 505][Stage 24:==============>                                       (140 + 1) / 505][Stage 24:===============>                                      (141 + 1) / 505][Stage 24:===============>                                      (143 + 1) / 505][Stage 24:===============>                                      (145 + 1) / 505][Stage 24:===============>                                      (146 + 1) / 505][Stage 24:===============>                                      (147 + 1) / 505][Stage 24:===============>                                      (149 + 1) / 505][Stage 24:================>                                     (150 + 1) / 505][Stage 24:================>                                     (151 + 1) / 505][Stage 24:================>                                     (153 + 1) / 505][Stage 24:================>                                     (155 + 1) / 505][Stage 24:================>                                     (157 + 1) / 505][Stage 24:=================>                                    (159 + 1) / 505][Stage 24:=================>                                    (160 + 1) / 505][Stage 24:=================>                                    (161 + 1) / 505][Stage 24:=================>                                    (163 + 1) / 505][Stage 24:=================>                                    (165 + 1) / 505][Stage 24:=================>                                    (166 + 1) / 505][Stage 24:=================>                                    (168 + 1) / 505][Stage 24:==================>                                   (169 + 1) / 505][Stage 24:==================>                                   (170 + 1) / 505][Stage 24:==================>                                   (171 + 1) / 505][Stage 24:==================>                                   (173 + 1) / 505][Stage 24:==================>                                   (175 + 1) / 505][Stage 24:==================>                                   (177 + 1) / 505][Stage 24:===================>                                  (180 + 1) / 505][Stage 24:===================>                                  (182 + 1) / 505][Stage 24:===================>                                  (184 + 1) / 505][Stage 24:===================>                                  (186 + 1) / 505][Stage 24:====================>                                 (188 + 1) / 505][Stage 24:====================>                                 (191 + 1) / 505][Stage 24:====================>                                 (193 + 1) / 505][Stage 24:====================>                                 (194 + 1) / 505][Stage 24:====================>                                 (196 + 1) / 505][Stage 24:=====================>                                (197 + 1) / 505][Stage 24:=====================>                                (199 + 1) / 505][Stage 24:=====================>                                (200 + 1) / 505][Stage 24:=====================>                                (201 + 1) / 505][Stage 24:=====================>                                (202 + 1) / 505][Stage 24:=====================>                                (203 + 1) / 505][Stage 24:=====================>                                (205 + 1) / 505][Stage 24:======================>                               (206 + 1) / 505][Stage 24:======================>                               (207 + 1) / 505][Stage 24:======================>                               (209 + 1) / 505][Stage 24:======================>                               (210 + 1) / 505][Stage 24:======================>                               (212 + 1) / 505][Stage 24:======================>                               (213 + 1) / 505][Stage 24:======================>                               (214 + 1) / 505][Stage 24:=======================>                              (216 + 1) / 505][Stage 24:=======================>                              (218 + 1) / 505][Stage 24:=======================>                              (220 + 1) / 505][Stage 24:=======================>                              (222 + 1) / 505][Stage 24:=======================>                              (223 + 1) / 505][Stage 24:========================>                             (225 + 1) / 505][Stage 24:========================>                             (226 + 1) / 505][Stage 24:========================>                             (228 + 1) / 505][Stage 24:========================>                             (230 + 1) / 505][Stage 24:========================>                             (233 + 1) / 505][Stage 24:=========================>                            (235 + 1) / 505][Stage 24:=========================>                            (236 + 1) / 505][Stage 24:=========================>                            (238 + 1) / 505][Stage 24:=========================>                            (240 + 1) / 505][Stage 24:=========================>                            (241 + 1) / 505][Stage 24:=========================>                            (243 + 1) / 505][Stage 24:==========================>                           (245 + 1) / 505][Stage 24:==========================>                           (247 + 1) / 505][Stage 24:==========================>                           (249 + 1) / 505][Stage 24:==========================>                           (251 + 1) / 505][Stage 24:===========================>                          (253 + 1) / 505][Stage 24:===========================>                          (254 + 1) / 505][Stage 24:===========================>                          (256 + 1) / 505][Stage 24:===========================>                          (257 + 1) / 505][Stage 24:===========================>                          (259 + 1) / 505][Stage 24:===========================>                          (260 + 1) / 505][Stage 24:============================>                         (262 + 1) / 505][Stage 24:============================>                         (264 + 1) / 505][Stage 24:============================>                         (265 + 1) / 505][Stage 24:============================>                         (266 + 1) / 505][Stage 24:============================>                         (267 + 1) / 505][Stage 24:============================>                         (269 + 1) / 505][Stage 24:============================>                         (270 + 1) / 505][Stage 24:=============================>                        (272 + 1) / 505][Stage 24:=============================>                        (273 + 1) / 505][Stage 24:=============================>                        (275 + 1) / 505][Stage 24:=============================>                        (276 + 1) / 505][Stage 24:=============================>                        (277 + 1) / 505][Stage 24:=============================>                        (279 + 1) / 505][Stage 24:=============================>                        (280 + 1) / 505][Stage 24:==============================>                       (282 + 1) / 505][Stage 24:==============================>                       (284 + 1) / 505][Stage 24:==============================>                       (285 + 1) / 505][I 11:25:40.254 NotebookApp] Saving file at /Test.ipynb
[Stage 24:==============================>                       (287 + 1) / 505][Stage 24:==============================>                       (288 + 1) / 505][Stage 24:==============================>                       (289 + 1) / 505][Stage 24:===============================>                      (290 + 1) / 505][Stage 24:===============================>                      (291 + 1) / 505][Stage 24:===============================>                      (292 + 1) / 505][Stage 24:===============================>                      (293 + 1) / 505][Stage 24:===============================>                      (294 + 1) / 505][Stage 24:===============================>                      (295 + 1) / 505][Stage 24:===============================>                      (296 + 1) / 505][Stage 24:===============================>                      (297 + 1) / 505][Stage 24:===============================>                      (298 + 1) / 505][Stage 24:===============================>                      (299 + 1) / 505][Stage 24:================================>                     (301 + 1) / 505][Stage 24:================================>                     (303 + 1) / 505][Stage 24:================================>                     (305 + 1) / 505][Stage 24:================================>                     (306 + 1) / 505][Stage 24:================================>                     (308 + 1) / 505][Stage 24:=================================>                    (309 + 1) / 505][Stage 24:=================================>                    (310 + 1) / 505][Stage 24:=================================>                    (311 + 1) / 505][Stage 24:=================================>                    (312 + 1) / 505][Stage 24:=================================>                    (313 + 1) / 505][Stage 24:=================================>                    (314 + 1) / 505][Stage 24:=================================>                    (315 + 1) / 505][Stage 24:=================================>                    (316 + 1) / 505][Stage 24:=================================>                    (317 + 1) / 505][Stage 24:==================================>                   (318 + 1) / 505][Stage 24:==================================>                   (319 + 1) / 505][Stage 24:==================================>                   (320 + 1) / 505][Stage 24:==================================>                   (321 + 1) / 505][Stage 24:==================================>                   (322 + 1) / 505][Stage 24:==================================>                   (324 + 1) / 505][Stage 24:==================================>                   (325 + 1) / 505][Stage 24:==================================>                   (326 + 1) / 505][Stage 24:==================================>                   (327 + 1) / 505][Stage 24:===================================>                  (328 + 1) / 505][Stage 24:===================================>                  (329 + 1) / 505][Stage 24:===================================>                  (330 + 1) / 505][Stage 24:===================================>                  (332 + 1) / 505][Stage 24:===================================>                  (333 + 1) / 505][Stage 24:===================================>                  (334 + 1) / 505][Stage 24:===================================>                  (336 + 1) / 505][Stage 24:====================================>                 (338 + 1) / 505][Stage 24:====================================>                 (340 + 1) / 505][Stage 24:====================================>                 (341 + 1) / 505][Stage 24:====================================>                 (342 + 1) / 505][Stage 24:====================================>                 (343 + 1) / 505][Stage 24:====================================>                 (345 + 1) / 505][Stage 24:====================================>                 (346 + 1) / 505][Stage 24:=====================================>                (347 + 1) / 505][Stage 24:=====================================>                (348 + 1) / 505][Stage 24:=====================================>                (349 + 1) / 505][Stage 24:=====================================>                (350 + 1) / 505][Stage 24:=====================================>                (351 + 1) / 505][Stage 24:=====================================>                (353 + 1) / 505][Stage 24:=====================================>                (354 + 1) / 505][Stage 24:=====================================>                (355 + 1) / 505][Stage 24:======================================>               (356 + 1) / 505][Stage 24:======================================>               (357 + 1) / 505][Stage 24:======================================>               (358 + 1) / 505][Stage 24:======================================>               (359 + 1) / 505][Stage 24:======================================>               (360 + 1) / 505][Stage 24:======================================>               (361 + 1) / 505][Stage 24:======================================>               (363 + 1) / 505][Stage 24:======================================>               (364 + 1) / 505][Stage 24:=======================================>              (366 + 1) / 505][Stage 24:=======================================>              (367 + 1) / 505][Stage 24:=======================================>              (369 + 1) / 505][Stage 24:=======================================>              (370 + 1) / 505][Stage 24:=======================================>              (371 + 1) / 505][Stage 24:=======================================>              (372 + 1) / 505][Stage 24:=======================================>              (373 + 1) / 505][Stage 24:=======================================>              (374 + 1) / 505][Stage 24:========================================>             (375 + 1) / 505][Stage 24:========================================>             (376 + 1) / 505][Stage 24:========================================>             (378 + 1) / 505][Stage 24:========================================>             (379 + 1) / 505][Stage 24:========================================>             (380 + 1) / 505][Stage 24:========================================>             (381 + 1) / 505][Stage 24:========================================>             (382 + 1) / 505][Stage 24:========================================>             (383 + 1) / 505][Stage 24:=========================================>            (386 + 1) / 505][Stage 24:=========================================>            (387 + 1) / 505][Stage 24:=========================================>            (388 + 1) / 505][Stage 24:=========================================>            (389 + 1) / 505][Stage 24:=========================================>            (391 + 1) / 505][Stage 24:==========================================>           (393 + 1) / 505][Stage 24:==========================================>           (395 + 1) / 505][Stage 24:==========================================>           (397 + 1) / 505][Stage 24:==========================================>           (398 + 1) / 505][Stage 24:==========================================>           (400 + 1) / 505][Stage 24:==========================================>           (402 + 1) / 505][Stage 24:===========================================>          (403 + 1) / 505][Stage 24:===========================================>          (405 + 1) / 505][Stage 24:===========================================>          (407 + 1) / 505][Stage 24:===========================================>          (408 + 1) / 505][Stage 24:===========================================>          (409 + 1) / 505][Stage 24:===========================================>          (411 + 1) / 505][Stage 24:============================================>         (413 + 1) / 505][Stage 24:============================================>         (414 + 1) / 505][Stage 24:============================================>         (416 + 1) / 505][Stage 24:============================================>         (418 + 1) / 505][Stage 24:============================================>         (420 + 1) / 505][Stage 24:=============================================>        (422 + 1) / 505][Stage 24:=============================================>        (424 + 1) / 505][Stage 24:=============================================>        (426 + 1) / 505][Stage 24:=============================================>        (428 + 1) / 505][Stage 24:=============================================>        (430 + 1) / 505][Stage 24:==============================================>       (432 + 1) / 505][Stage 24:==============================================>       (434 + 1) / 505][Stage 24:==============================================>       (435 + 1) / 505][Stage 24:==============================================>       (437 + 1) / 505][Stage 24:==============================================>       (439 + 1) / 505][Stage 24:===============================================>      (441 + 1) / 505][Stage 24:===============================================>      (443 + 1) / 505][Stage 24:===============================================>      (444 + 1) / 505][Stage 24:===============================================>      (446 + 1) / 505][Stage 24:===============================================>      (448 + 1) / 505][Stage 24:================================================>     (450 + 1) / 505][Stage 24:================================================>     (451 + 1) / 505][Stage 24:================================================>     (452 + 1) / 505][Stage 24:================================================>     (453 + 1) / 505][Stage 24:================================================>     (455 + 1) / 505][Stage 24:================================================>     (456 + 1) / 505][Stage 24:================================================>     (458 + 1) / 505][Stage 24:=================================================>    (460 + 1) / 505][Stage 24:=================================================>    (461 + 1) / 505][Stage 24:=================================================>    (462 + 1) / 505][Stage 24:=================================================>    (464 + 1) / 505][Stage 24:=================================================>    (465 + 1) / 505][Stage 24:=================================================>    (466 + 1) / 505][Stage 24:==================================================>   (468 + 1) / 505][Stage 24:==================================================>   (470 + 1) / 505][Stage 24:==================================================>   (472 + 1) / 505][Stage 24:==================================================>   (474 + 1) / 505][Stage 24:==================================================>   (475 + 1) / 505][Stage 24:===================================================>  (477 + 1) / 505][Stage 24:===================================================>  (479 + 1) / 505][Stage 24:===================================================>  (481 + 1) / 505][Stage 24:===================================================>  (483 + 1) / 505][Stage 24:===================================================>  (484 + 1) / 505][Stage 24:===================================================>  (486 + 1) / 505][Stage 24:====================================================> (488 + 1) / 505][Stage 24:====================================================> (490 + 1) / 505][Stage 24:====================================================> (492 + 1) / 505][Stage 24:====================================================> (494 + 1) / 505][Stage 24:=====================================================>(496 + 1) / 505][Stage 24:=====================================================>(498 + 1) / 505][Stage 24:=====================================================>(500 + 1) / 505][Stage 24:=====================================================>(501 + 1) / 505][Stage 24:=====================================================>(503 + 1) / 505]                                                                                [I 11:27:40.291 NotebookApp] Saving file at /Test.ipynb
[I 11:51:40.712 NotebookApp] Saving file at /Test.ipynb
[I 11:53:41.247 NotebookApp] Saving file at /Test.ipynb
[I 11:59:40.898 NotebookApp] Saving file at /Test.ipynb
[Stage 27:====>                                                    (2 + 1) / 25][Stage 27:======>                                                  (3 + 1) / 25][Stage 27:=========>                                               (4 + 1) / 25][Stage 27:===========>                                             (5 + 1) / 25][Stage 27:===============>                                         (7 + 1) / 25][Stage 27:====================>                                    (9 + 1) / 25][Stage 27:======================>                                 (10 + 1) / 25][Stage 27:========================>                               (11 + 2) / 25][Stage 27:=============================>                          (13 + 1) / 25][Stage 27:=================================>                      (15 + 1) / 25][Stage 27:===================================>                    (16 + 1) / 25][Stage 27:========================================>               (18 + 1) / 25][Stage 27:==========================================>             (19 + 1) / 25][Stage 27:===============================================>        (21 + 1) / 25][Stage 27:===================================================>    (23 + 1) / 25][Stage 27:=====================================================>  (24 + 1) / 25]                                                                                [Stage 30:===============>                                         (7 + 1) / 25][Stage 30:========================>                               (11 + 1) / 25][Stage 30:===============================>                        (14 + 1) / 25][Stage 30:======================================>                 (17 + 1) / 25][Stage 30:========================================>               (18 + 1) / 25][Stage 30:============================================>           (20 + 1) / 25][Stage 30:=================================================>      (22 + 1) / 25]                                                                                [I 12:01:41.483 NotebookApp] Saving file at /Test.ipynb
[I 12:27:41.368 NotebookApp] Saving file at /Test.ipynb
[I 12:29:41.872 NotebookApp] Saving file at /Test.ipynb
[Stage 43:>                                                        (0 + 1) / 25][Stage 43:==>                                                      (1 + 1) / 25][Stage 43:====>                                                    (2 + 1) / 25][Stage 43:======>                                                  (3 + 1) / 25][Stage 43:=========>                                               (4 + 1) / 25][Stage 43:===========>                                             (5 + 1) / 25][Stage 43:===============>                                         (7 + 1) / 25][Stage 43:====================>                                    (9 + 1) / 25][Stage 43:======================>                                 (10 + 1) / 25][Stage 43:==========================>                             (12 + 1) / 25][Stage 43:=============================>                          (13 + 1) / 25][Stage 43:=================================>                      (15 + 1) / 25][Stage 43:===================================>                    (16 + 2) / 25][Stage 43:========================================>               (18 + 1) / 25][Stage 43:============================================>           (20 + 1) / 25][Stage 43:===============================================>        (21 + 1) / 25][Stage 43:=================================================>      (22 + 1) / 25][Stage 43:=====================================================>  (24 + 1) / 25]                                                                                [Stage 46:======>                                                  (3 + 1) / 25][Stage 46:===========>                                             (5 + 1) / 25][I 14:43:44.557 NotebookApp] Saving file at /Test.ipynb
[Stage 46:===============>                                         (7 + 1) / 25][Stage 46:======================>                                 (10 + 1) / 25][Stage 46:=============================>                          (13 + 1) / 25][Stage 46:===================================>                    (16 + 1) / 25][Stage 46:==========================================>             (19 + 1) / 25][Stage 46:=================================================>      (22 + 1) / 25]                                                                                [I 14:45:45.082 NotebookApp] Saving file at /Test.ipynb
[I 14:47:45.021 NotebookApp] Saving file at /Test.ipynb
[I 16:17:42.067 NotebookApp] Starting buffering for aaa498c4-fb6d-402d-aea0-005e745e910e:caf8043eb0944163855f0efb49faa835
[W 11:55:03.878 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 11:55:03.881 NotebookApp] The port 8888 is already in use, trying another port.
[I 11:55:03.881 NotebookApp] The port 8889 is already in use, trying another port.
[I 11:55:03.881 NotebookApp] The port 8890 is already in use, trying another port.
[I 11:55:03.881 NotebookApp] The port 8891 is already in use, trying another port.
[I 11:55:03.881 NotebookApp] The port 8892 is already in use, trying another port.
[I 11:55:03.881 NotebookApp] Serving notebooks from local directory: /home/user/spark_code
[I 11:55:03.881 NotebookApp] Jupyter Notebook 6.4.8 is running at:
[I 11:55:03.881 NotebookApp] http://server:8957/?token=2965ddc7b724d9557ad011c360c95ee2575034179068c499
[I 11:55:03.881 NotebookApp]  or http://127.0.0.1:8957/?token=2965ddc7b724d9557ad011c360c95ee2575034179068c499
[I 11:55:03.881 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 11:55:03.884 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///home/user/.local/share/jupyter/runtime/nbserver-7064-open.html
    Or copy and paste one of these URLs:
        http://server:8957/?token=2965ddc7b724d9557ad011c360c95ee2575034179068c499
     or http://127.0.0.1:8957/?token=2965ddc7b724d9557ad011c360c95ee2575034179068c499
[I 11:55:39.730 NotebookApp] 302 GET /?token=2965ddc7b724d9557ad011c360c95ee2575034179068c499 (192.168.1.51) 0.590000ms
[W 11:55:44.938 NotebookApp] Notebook Test.ipynb is not trusted
[I 11:55:45.472 NotebookApp] Kernel started: 6cfe3035-4f46-4629-8256-4dc26d3b86ee, name: python3
[I 11:55:49.437 NotebookApp] Starting buffering for 6cfe3035-4f46-4629-8256-4dc26d3b86ee:f7261c436b0046a7a1706ff54d3d4c45
[I 11:55:49.672 NotebookApp] Kernel restarted: 6cfe3035-4f46-4629-8256-4dc26d3b86ee
[I 11:55:49.684 NotebookApp] Restoring connection for 6cfe3035-4f46-4629-8256-4dc26d3b86ee:f7261c436b0046a7a1706ff54d3d4c45
[I 11:55:50.538 NotebookApp] Replaying 3 buffered messages
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
22/04/29 11:55:58 WARN util.Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
22/04/29 11:55:58 WARN util.Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
22/04/29 11:55:58 WARN util.Utils: Service 'SparkUI' could not bind on port 4042. Attempting port 4043.
22/04/29 11:55:58 WARN util.Utils: Service 'SparkUI' could not bind on port 4043. Attempting port 4044.
22/04/29 11:55:58 WARN util.Utils: Service 'SparkUI' could not bind on port 4044. Attempting port 4045.
22/04/29 11:55:58 WARN util.Utils: Service 'SparkUI' could not bind on port 4045. Attempting port 4046.
22/04/29 11:55:58 WARN util.Utils: Service 'SparkUI' could not bind on port 4046. Attempting port 4047.
22/04/29 11:55:58 WARN util.Utils: Service 'SparkUI' could not bind on port 4047. Attempting port 4048.
22/04/29 11:55:58 WARN util.Utils: Service 'SparkUI' could not bind on port 4048. Attempting port 4049.
22/04/29 11:55:58 WARN util.Utils: Service 'SparkUI' could not bind on port 4049. Attempting port 4050.
[I 11:57:45.508 NotebookApp] Saving file at /Test.ipynb
[I 11:59:45.572 NotebookApp] Saving file at /Test.ipynb
[Stage 0:>                                                          (0 + 1) / 1]                                                                                [Stage 8:========================================>               (73 + 1) / 100]                                                                                [I 12:01:45.615 NotebookApp] Saving file at /Test.ipynb
[I 12:07:45.697 NotebookApp] Saving file at /Test.ipynb
[I 12:09:45.754 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 12:11:45.806 NotebookApp] Saving file at /Test.ipynb
[I 12:13:45.874 NotebookApp] Saving file at /Test.ipynb
[I 12:59:46.689 NotebookApp] Saving file at /Test.ipynb
[I 13:01:47.128 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 13:05:46.705 NotebookApp] Saving file at /Test.ipynb
[I 13:07:46.769 NotebookApp] Saving file at /Test.ipynb
[Stage 20:>                                                         (0 + 1) / 4][Stage 20:==============>                                           (1 + 1) / 4][Stage 20:=============================>                            (2 + 1) / 4][Stage 20:===========================================>              (3 + 1) / 4]                                                                                [Stage 27:=============================>                         (53 + 1) / 100][Stage 27:=============================================>         (83 + 1) / 100]                                                                                [Stage 29:======================================================> (73 + 1) / 75]                                                                                [Stage 30:>                                                         (0 + 1) / 4][Stage 30:==============>                                           (1 + 1) / 4][Stage 30:=============================>                            (2 + 1) / 4][Stage 30:===========================================>              (3 + 1) / 4]                                                                                [I 13:09:46.832 NotebookApp] Saving file at /Test.ipynb
[Stage 32:>                                                         (0 + 1) / 4][Stage 32:==============>                                           (1 + 1) / 4][Stage 32:=============================>                            (2 + 1) / 4][Stage 32:===========================================>              (3 + 1) / 4]                                                                                [I 13:11:46.896 NotebookApp] Saving file at /Test.ipynb
[Stage 34:>                                                         (0 + 1) / 4][Stage 34:==============>                                           (1 + 1) / 4][Stage 34:=============================>                            (2 + 1) / 4][I 13:13:46.925 NotebookApp] Saving file at /Test.ipynb
[Stage 34:===========================================>              (3 + 1) / 4]                                                                                [Stage 36:>                                                         (0 + 1) / 4][Stage 36:==============>                                           (1 + 1) / 4][Stage 36:=============================>                            (2 + 1) / 4][Stage 36:===========================================>              (3 + 1) / 4]                                                                                [Stage 43:====================>                                 (38 + 62) / 100]                                                                                [IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 13:15:46.904 NotebookApp] Saving file at /Test.ipynb
[Stage 46:>                                                         (0 + 1) / 4][Stage 46:==============>                                           (1 + 1) / 4][Stage 46:=============================>                            (2 + 1) / 4][Stage 46:===========================================>              (3 + 1) / 4]                                                                                [Stage 53:=============================================>         (83 + 2) / 100]                                                                                [I 13:17:46.962 NotebookApp] Saving file at /Test.ipynb
[Stage 56:>                                                         (0 + 1) / 4][Stage 56:==============>                                           (1 + 1) / 4][Stage 56:=============================>                            (2 + 1) / 4][Stage 56:===========================================>              (3 + 1) / 4][Stage 57:===>                                                   (14 + 1) / 200][Stage 57:======>                                                (23 + 1) / 200][Stage 57:========>                                              (30 + 1) / 200][Stage 57:==========>                                            (39 + 1) / 200][Stage 57:============>                                          (46 + 2) / 200][Stage 57:===============>                                       (56 + 1) / 200][Stage 57:==================>                                    (67 + 1) / 200][Stage 57:====================>                                  (75 + 2) / 200][Stage 57:=======================>                               (85 + 1) / 200][Stage 57:=========================>                             (92 + 1) / 200][Stage 57:===========================>                          (102 + 1) / 200][Stage 57:=============================>                        (109 + 1) / 200][Stage 57:================================>                     (120 + 1) / 200][Stage 57:===================================>                  (131 + 1) / 200][Stage 57:======================================>               (142 + 1) / 200][Stage 57:========================================>             (151 + 1) / 200][Stage 57:============================================>         (163 + 1) / 200][Stage 57:==============================================>       (172 + 1) / 200][Stage 57:================================================>     (180 + 1) / 200][Stage 57:===================================================>  (190 + 1) / 200]                                                                                [Stage 59:>                                                        (0 + 1) / 25][Stage 59:==>                                                      (1 + 1) / 25][Stage 59:====>                                                    (2 + 1) / 25][Stage 59:======>                                                  (3 + 1) / 25][Stage 59:=========>                                               (4 + 1) / 25][Stage 59:===========>                                             (5 + 1) / 25][Stage 59:=============>                                           (6 + 1) / 25][Stage 59:===============>                                         (7 + 1) / 25][Stage 59:==================>                                      (8 + 1) / 25][Stage 59:====================>                                    (9 + 1) / 25][Stage 59:======================>                                 (10 + 1) / 25][Stage 59:========================>                               (11 + 1) / 25][Stage 59:==========================>                             (12 + 1) / 25][Stage 59:=============================>                          (13 + 1) / 25][Stage 59:===============================>                        (14 + 1) / 25][Stage 59:=================================>                      (15 + 1) / 25][Stage 59:===================================>                    (16 + 1) / 25][Stage 59:======================================>                 (17 + 1) / 25][Stage 59:========================================>               (18 + 1) / 25][Stage 59:==========================================>             (19 + 1) / 25][Stage 59:============================================>           (20 + 1) / 25][Stage 59:===============================================>        (21 + 1) / 25][Stage 59:=================================================>      (22 + 1) / 25][Stage 59:===================================================>    (23 + 1) / 25][Stage 59:=====================================================>  (24 + 1) / 25]                                                                                [I 13:19:47.399 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 13:25:47.088 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 13:27:47.533 NotebookApp] Saving file at /Test.ipynb
[C 13:34:09.143 NotebookApp] received signal 15, stopping
[C 13:34:09.145 NotebookApp] received signal 15, stopping
[I 13:34:09.620 NotebookApp] Shutting down 1 kernel
[I 13:34:09.641 NotebookApp] Shutting down 1 kernel
[I 13:34:10.859 NotebookApp] Kernel shutdown: aaa498c4-fb6d-402d-aea0-005e745e910e
[I 13:34:10.859 NotebookApp] Kernel shutdown: 6cfe3035-4f46-4629-8256-4dc26d3b86ee
[I 13:34:10.860 NotebookApp] KernelRestarter: restarting kernel (1/5), keep random ports
WARNING:root:kernel 6cfe3035-4f46-4629-8256-4dc26d3b86ee restarted
[I 13:34:10.870 NotebookApp] Shutting down 0 terminals
[E 13:34:11.062 NotebookApp] Exception in callback <bound method KernelRestarter.poll of <jupyter_client.ioloop.restarter.IOLoopKernelRestarter object at 0x7fa0c7487c70>>
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 479, in _async_shutdown_kernel
        await ensure_async(self.interrupt_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 587, in _async_interrupt_kernel
        raise RuntimeError("Cannot interrupt kernel. No kernel is running!")
    RuntimeError: Cannot interrupt kernel. No kernel is running!
    
    During handling of the above exception, another exception occurred:
    
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/tornado/ioloop.py", line 905, in _run
        return self.callback()
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/restarter.py", line 143, in poll
        self.kernel_manager.restart_kernel(now=True, newports=newports)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 523, in _async_restart_kernel
        await ensure_async(self.shutdown_kernel(now=now, restart=True))
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 77, in wrapper
        self._ready.set_exception(e)
    asyncio.exceptions.InvalidStateError: invalid state
[I 13:34:11.127 NotebookApp] Shutting down 0 terminals
[C 13:34:10.850 NotebookApp] received signal 15, stopping
[C 13:34:11.063 NotebookApp] received signal 15, stopping
[I 13:34:11.240 NotebookApp] KernelRestarter: restarting kernel (1/5), keep random ports
[C 13:34:11.223 NotebookApp] received signal 15, stopping
[E 13:34:11.256 NotebookApp] Event loop stopped before Future completed.
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 482, in _async_shutdown_kernel
        await ensure_async(self._kill_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 79, in run_until_complete
        raise RuntimeError(
    RuntimeError: Event loop stopped before Future completed.
[E 13:34:11.290 NotebookApp] Exception in callback <bound method KernelRestarter.poll of <jupyter_client.ioloop.restarter.IOLoopKernelRestarter object at 0x7f6f721f7f70>>
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/tornado/ioloop.py", line 905, in _run
        return self.callback()
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/restarter.py", line 143, in poll
        self.kernel_manager.restart_kernel(now=True, newports=newports)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 523, in _async_restart_kernel
        await ensure_async(self.shutdown_kernel(now=now, restart=True))
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 79, in wrapper
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 482, in _async_shutdown_kernel
        await ensure_async(self._kill_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 79, in run_until_complete
        raise RuntimeError(
    RuntimeError: Event loop stopped before Future completed.
[I 13:34:11.302 NotebookApp] KernelRestarter: restarting kernel (1/5), keep random ports
[E 13:34:11.303 NotebookApp] Event loop stopped before Future completed.
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 482, in _async_shutdown_kernel
        await ensure_async(self._kill_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 79, in run_until_complete
        raise RuntimeError(
    RuntimeError: Event loop stopped before Future completed.
[E 13:34:11.303 NotebookApp] Exception in callback <bound method KernelRestarter.poll of <jupyter_client.ioloop.restarter.IOLoopKernelRestarter object at 0x7f6f744917f0>>
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/tornado/ioloop.py", line 905, in _run
        return self.callback()
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/restarter.py", line 143, in poll
        self.kernel_manager.restart_kernel(now=True, newports=newports)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 523, in _async_restart_kernel
        await ensure_async(self.shutdown_kernel(now=now, restart=True))
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 79, in wrapper
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 482, in _async_shutdown_kernel
        await ensure_async(self._kill_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 79, in run_until_complete
        raise RuntimeError(
    RuntimeError: Event loop stopped before Future completed.
[I 13:34:11.313 NotebookApp] Shutting down 3 kernels
[C 13:34:11.237 NotebookApp] received signal 15, stopping
[I 13:34:11.323 NotebookApp] KernelRestarter: restarting kernel (1/5), keep random ports
[I 13:34:11.356 NotebookApp] Kernel shutdown: dde176cf-8deb-4ab8-acab-172808121c73
[I 13:34:11.357 NotebookApp] Kernel shutdown: 8f378dcf-b7eb-4949-a252-29df27c582ad
[I 13:34:11.357 NotebookApp] Kernel shutdown: ef3e8642-8ce6-420a-a8c7-337787a168bf
[I 13:34:11.388 NotebookApp] Shutting down 0 terminals
[E 13:34:11.351 NotebookApp] Event loop stopped before Future completed.
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 482, in _async_shutdown_kernel
        await ensure_async(self._kill_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 79, in run_until_complete
        raise RuntimeError(
    RuntimeError: Event loop stopped before Future completed.
[I 13:34:11.393 NotebookApp] Shutting down 0 kernels
[E 13:34:11.393 NotebookApp] Exception in callback <bound method KernelRestarter.poll of <jupyter_client.ioloop.restarter.IOLoopKernelRestarter object at 0x7f646cb496d0>>
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/tornado/ioloop.py", line 905, in _run
        return self.callback()
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/restarter.py", line 143, in poll
        self.kernel_manager.restart_kernel(now=True, newports=newports)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 523, in _async_restart_kernel
        await ensure_async(self.shutdown_kernel(now=now, restart=True))
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 79, in wrapper
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 482, in _async_shutdown_kernel
        await ensure_async(self._kill_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 79, in run_until_complete
        raise RuntimeError(
    RuntimeError: Event loop stopped before Future completed.
[I 13:34:11.728 NotebookApp] KernelRestarter: restarting kernel (1/5), keep random ports
[E 13:34:11.731 NotebookApp] Event loop stopped before Future completed.
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 482, in _async_shutdown_kernel
        await ensure_async(self._kill_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 79, in run_until_complete
        raise RuntimeError(
    RuntimeError: Event loop stopped before Future completed.
[E 13:34:11.732 NotebookApp] Exception in callback <bound method KernelRestarter.poll of <jupyter_client.ioloop.restarter.IOLoopKernelRestarter object at 0x7f646edf3f10>>
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/tornado/ioloop.py", line 905, in _run
        return self.callback()
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/restarter.py", line 143, in poll
        self.kernel_manager.restart_kernel(now=True, newports=newports)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 523, in _async_restart_kernel
        await ensure_async(self.shutdown_kernel(now=now, restart=True))
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 79, in wrapper
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 482, in _async_shutdown_kernel
        await ensure_async(self._kill_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 79, in run_until_complete
        raise RuntimeError(
    RuntimeError: Event loop stopped before Future completed.
[I 13:34:11.733 NotebookApp] KernelRestarter: restarting kernel (1/5), keep random ports
[E 13:34:11.736 NotebookApp] Event loop stopped before Future completed.
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 482, in _async_shutdown_kernel
        await ensure_async(self._kill_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 79, in run_until_complete
        raise RuntimeError(
    RuntimeError: Event loop stopped before Future completed.
[E 13:34:11.736 NotebookApp] Exception in callback <bound method KernelRestarter.poll of <jupyter_client.ioloop.restarter.IOLoopKernelRestarter object at 0x7f646ede2a30>>
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/tornado/ioloop.py", line 905, in _run
        return self.callback()
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/restarter.py", line 143, in poll
        self.kernel_manager.restart_kernel(now=True, newports=newports)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 523, in _async_restart_kernel
        await ensure_async(self.shutdown_kernel(now=now, restart=True))
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 79, in wrapper
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 482, in _async_shutdown_kernel
        await ensure_async(self._kill_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 79, in run_until_complete
        raise RuntimeError(
    RuntimeError: Event loop stopped before Future completed.
[I 13:34:11.898 NotebookApp] Shutting down 0 terminals
[I 13:34:11.900 NotebookApp] Shutting down 3 kernels
[I 13:34:11.917 NotebookApp] KernelRestarter: restarting kernel (1/5), keep random ports
[I 13:34:12.368 NotebookApp] Kernel shutdown: cbe20edb-6cd4-4869-94f6-02ee3bf3b544
[I 13:34:12.401 NotebookApp] Kernel shutdown: b2a34b42-a8f4-41c4-b734-4038ac788aaa
[I 13:34:12.401 NotebookApp] Kernel shutdown: 66f2187e-a574-42b5-a97b-c387ff4b88e9
[I 13:34:12.409 NotebookApp] Shutting down 0 terminals
[E 13:34:12.180 NotebookApp] Event loop stopped before Future completed.
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 482, in _async_shutdown_kernel
        await ensure_async(self._kill_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 79, in run_until_complete
        raise RuntimeError(
    RuntimeError: Event loop stopped before Future completed.
[C 13:34:11.961 NotebookApp] received signal 15, stopping
[E 13:34:13.023 NotebookApp] Exception in callback <bound method KernelRestarter.poll of <jupyter_client.ioloop.restarter.IOLoopKernelRestarter object at 0x7f58e3994df0>>
    Traceback (most recent call last):
      File "/home/user/.local/lib/python3.8/site-packages/tornado/ioloop.py", line 905, in _run
        return self.callback()
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/restarter.py", line 143, in poll
        self.kernel_manager.restart_kernel(now=True, newports=newports)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 523, in _async_restart_kernel
        await ensure_async(self.shutdown_kernel(now=now, restart=True))
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 81, in run_until_complete
        return f.result()
      File "/usr/lib/python3.8/asyncio/futures.py", line 178, in result
        raise self._exception
      File "/usr/lib/python3.8/asyncio/tasks.py", line 280, in __step
        result = coro.send(None)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 79, in wrapper
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 71, in wrapper
        out = await method(self, *args, **kwargs)
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/manager.py", line 482, in _async_shutdown_kernel
        await ensure_async(self._kill_kernel())
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 26, in wrapped
        raise e
      File "/home/user/.local/lib/python3.8/site-packages/jupyter_client/utils.py", line 23, in wrapped
        return loop.run_until_complete(future)
      File "/home/user/.local/lib/python3.8/site-packages/nest_asyncio.py", line 79, in run_until_complete
        raise RuntimeError(
    RuntimeError: Event loop stopped before Future completed.
[I 13:34:13.221 NotebookApp] Shutting down 1 kernel
[I 13:34:13.485 NotebookApp] Kernel shutdown: ab2a31fe-0a88-4ebf-91b5-2227480f124c
[I 13:34:13.505 NotebookApp] Shutting down 0 terminals
[I 13:34:13.527 NotebookApp] Shutting down 0 kernels
[I 13:34:14.106 NotebookApp] Shutting down 0 terminals
[W 13:38:00.471 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 13:38:00.479 NotebookApp] Serving notebooks from local directory: /home/user/spark_code
[I 13:38:00.479 NotebookApp] Jupyter Notebook 6.4.8 is running at:
[I 13:38:00.479 NotebookApp] http://server:8888/?token=94cc56f0a30f43058af11457c11d94ac22d44f4ac4f91d72
[I 13:38:00.479 NotebookApp]  or http://127.0.0.1:8888/?token=94cc56f0a30f43058af11457c11d94ac22d44f4ac4f91d72
[I 13:38:00.479 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 13:38:00.486 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///home/user/.local/share/jupyter/runtime/nbserver-3340-open.html
    Or copy and paste one of these URLs:
        http://server:8888/?token=94cc56f0a30f43058af11457c11d94ac22d44f4ac4f91d72
     or http://127.0.0.1:8888/?token=94cc56f0a30f43058af11457c11d94ac22d44f4ac4f91d72
[I 13:38:52.960 NotebookApp] 302 GET /?token=94cc56f0a30f43058af11457c11d94ac22d44f4ac4f91d72 (192.168.1.51) 0.340000ms
[W 13:38:56.644 NotebookApp] Notebook Test.ipynb is not trusted
[I 13:38:57.329 NotebookApp] Kernel started: 3484497c-9631-4433-8df6-8209a5adf491, name: python3
[I 13:39:02.026 NotebookApp] Starting buffering for 3484497c-9631-4433-8df6-8209a5adf491:6ee5a9cd5e284860902e304a09ff5767
[I 13:39:02.256 NotebookApp] Kernel restarted: 3484497c-9631-4433-8df6-8209a5adf491
[I 13:39:02.264 NotebookApp] Restoring connection for 3484497c-9631-4433-8df6-8209a5adf491:6ee5a9cd5e284860902e304a09ff5767
[I 13:39:03.113 NotebookApp] Replaying 3 buffered messages
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
22/04/29 13:39:09 WARN util.Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
22/04/29 13:39:09 WARN util.Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
22/04/29 13:39:09 WARN util.Utils: Service 'SparkUI' could not bind on port 4042. Attempting port 4043.
[Stage 0:>                                                          (0 + 1) / 1]                                                                                [I 13:40:57.385 NotebookApp] Saving file at /Test.ipynb
[Stage 1:>                                                         (0 + 1) / 25][Stage 1:==>                                                       (1 + 1) / 25][Stage 1:====>                                                     (2 + 1) / 25][Stage 1:======>                                                   (3 + 1) / 25][Stage 1:=========>                                                (4 + 1) / 25][Stage 1:===========>                                              (5 + 1) / 25][Stage 1:=============>                                            (6 + 1) / 25][Stage 1:================>                                         (7 + 1) / 25][Stage 1:==================>                                       (8 + 1) / 25][Stage 1:====================>                                     (9 + 1) / 25][Stage 1:======================>                                  (10 + 1) / 25][Stage 1:=========================>                               (11 + 1) / 25][Stage 1:===========================>                             (12 + 1) / 25][Stage 1:=============================>                           (13 + 1) / 25][Stage 1:===============================>                         (14 + 1) / 25][Stage 1:==================================>                      (15 + 1) / 25][Stage 1:====================================>                    (16 + 1) / 25][Stage 1:======================================>                  (17 + 1) / 25][Stage 1:=========================================>               (18 + 1) / 25][Stage 1:===========================================>             (19 + 1) / 25][Stage 1:=============================================>           (20 + 1) / 25][Stage 1:===============================================>         (21 + 1) / 25][Stage 1:==================================================>      (22 + 1) / 25][Stage 1:====================================================>    (23 + 1) / 25][Stage 1:======================================================>  (24 + 1) / 25]                                                                                [I 13:48:57.607 NotebookApp] Saving file at /Test.ipynb
[I 13:50:57.672 NotebookApp] Saving file at /Test.ipynb
[Stage 5:>                                                          (0 + 1) / 4][Stage 5:==============>                                            (1 + 1) / 4][Stage 5:=============================>                             (2 + 1) / 4][Stage 5:============================================>              (3 + 1) / 4]                                                                                [I 13:56:57.855 NotebookApp] Saving file at /Test.ipynb
[I 13:58:57.911 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[Stage 7:>                                                          (0 + 1) / 4][Stage 7:==============>                                            (1 + 1) / 4][Stage 7:=============================>                             (2 + 1) / 4][Stage 7:============================================>              (3 + 1) / 4]                                                                                [Stage 14:==============>                                        (27 + 1) / 100][Stage 14:===================>                                   (35 + 1) / 100][Stage 14:=========================>                             (47 + 1) / 100][Stage 14:==================================>                    (62 + 1) / 100][Stage 14:============================================>          (80 + 1) / 100]                                                                                [I 14:00:58.076 NotebookApp] Saving file at /Test.ipynb
[Stage 17:>                                                         (0 + 1) / 4][Stage 17:==============>                                           (1 + 1) / 4][Stage 17:=============================>                            (2 + 1) / 4][Stage 17:===========================================>              (3 + 1) / 4][Stage 18:=====>                                                 (21 + 1) / 200][Stage 18:========>                                              (31 + 1) / 200][Stage 18:==========>                                            (38 + 1) / 200][Stage 18:============>                                          (46 + 1) / 200][Stage 18:===============>                                       (55 + 1) / 200][Stage 18:=================>                                     (63 + 1) / 200][Stage 18:====================>                                  (74 + 1) / 200][Stage 18:======================>                                (82 + 1) / 200][Stage 18:========================>                              (88 + 1) / 200][Stage 18:==========================>                            (96 + 2) / 200][Stage 18:============================>                         (107 + 1) / 200][Stage 18:==============================>                       (114 + 1) / 200][Stage 18:================================>                     (121 + 1) / 200][Stage 18:==================================>                   (127 + 1) / 200][Stage 18:===================================>                  (132 + 1) / 200][Stage 18:=====================================>                (138 + 1) / 200][Stage 18:======================================>               (144 + 1) / 200][Stage 18:=========================================>            (152 + 1) / 200][Stage 18:=========================================>            (155 + 1) / 200][Stage 18:===========================================>          (161 + 1) / 200][Stage 18:=============================================>        (170 + 1) / 200][Stage 18:===============================================>      (176 + 1) / 200][Stage 18:=================================================>    (182 + 1) / 200][Stage 18:===================================================>  (190 + 1) / 200][Stage 18:====================================================> (193 + 1) / 200]                                                                                [I 14:06:58.154 NotebookApp] Saving file at /Test.ipynb
[Stage 19:>                                                         (0 + 1) / 4][Stage 19:==============>                                           (1 + 1) / 4][Stage 19:=============================>                            (2 + 1) / 4][I 14:08:58.212 NotebookApp] Saving file at /Test.ipynb
[Stage 19:===========================================>              (3 + 1) / 4][Stage 20:======================>                                (80 + 1) / 200][Stage 20:============================>                         (107 + 1) / 200][Stage 20:===================================>                  (130 + 5) / 200][Stage 20:===========================================>          (160 + 1) / 200][Stage 20:===================================================>  (190 + 1) / 200][Stage 21:=====>                                                 (21 + 1) / 200][Stage 21:=========>                                             (34 + 1) / 200][Stage 21:============>                                          (46 + 1) / 200][Stage 21:===============>                                       (56 + 1) / 200][Stage 21:==================>                                    (68 + 1) / 200][Stage 21:====================>                                  (75 + 1) / 200][Stage 21:======================>                                (80 + 1) / 200][Stage 21:========================>                              (88 + 1) / 200][Stage 21:==========================>                            (97 + 1) / 200][Stage 21:============================>                         (106 + 1) / 200][Stage 21:==============================>                       (114 + 1) / 200][Stage 21:================================>                     (121 + 1) / 200][Stage 21:==================================>                   (129 + 1) / 200][Stage 21:====================================>                 (135 + 1) / 200][Stage 21:======================================>               (142 + 1) / 200][Stage 21:========================================>             (150 + 1) / 200][Stage 21:==========================================>           (158 + 1) / 200][Stage 21:============================================>         (164 + 1) / 200][Stage 21:=============================================>        (170 + 1) / 200][Stage 21:===============================================>      (175 + 1) / 200][Stage 21:=================================================>    (183 + 1) / 200][Stage 21:====================================================> (193 + 1) / 200]                                                                                [Stage 22:>                                                         (0 + 1) / 4][Stage 22:==============>                                           (1 + 1) / 4][Stage 22:=============================>                            (2 + 1) / 4][Stage 22:===========================================>              (3 + 1) / 4][Stage 23:===============>                                       (56 + 1) / 200][Stage 23:=====================>                                 (79 + 1) / 200][Stage 23:==========================>                            (96 + 1) / 200][Stage 23:===============================>                      (116 + 1) / 200][Stage 23:=====================================>                (138 + 1) / 200][Stage 23:=============================================>        (168 + 1) / 200][Stage 23:===================================================>  (189 + 1) / 200]                                                                                [Stage 33:===================================>                   (65 + 1) / 100][Stage 33:==============================================>        (85 + 1) / 100]                                                                                [Stage 36:==========================>                             (36 + 1) / 75][Stage 36:==========================================>             (57 + 2) / 75][Stage 36:=====================================================>  (72 + 1) / 75]                                                                                [Stage 38:===================>                                      (1 + 1) / 3][Stage 38:======================================>                   (2 + 1) / 3]                                                                                [Stage 41:====>                                                    (2 + 1) / 25][Stage 41:======>                                                  (3 + 1) / 25][Stage 41:=========>                                               (4 + 1) / 25][Stage 41:===========>                                             (5 + 1) / 25][Stage 41:=============>                                           (6 + 1) / 25][Stage 41:===============>                                         (7 + 1) / 25][Stage 41:==================>                                      (8 + 1) / 25][Stage 41:======================>                                 (10 + 1) / 25][Stage 41:========================>                               (11 + 1) / 25][Stage 41:==========================>                             (12 + 1) / 25][Stage 41:=============================>                          (13 + 1) / 25][Stage 41:===============================>                        (14 + 1) / 25][Stage 41:===================================>                    (16 + 1) / 25][Stage 41:======================================>                 (17 + 1) / 25][Stage 41:========================================>               (18 + 1) / 25][Stage 41:==========================================>             (19 + 1) / 25][Stage 41:============================================>           (20 + 1) / 25][Stage 41:===============================================>        (21 + 1) / 25][Stage 41:===================================================>    (23 + 1) / 25][Stage 41:=====================================================>  (24 + 1) / 25]                                                                                [I 14:10:58.267 NotebookApp] Saving file at /Test.ipynb
[Stage 44:==================>                                      (8 + 1) / 25][Stage 44:========================>                               (11 + 1) / 25][Stage 44:===============================>                        (14 + 1) / 25][Stage 44:======================================>                 (17 + 1) / 25][Stage 44:==========================================>             (19 + 1) / 25][Stage 44:===================================================>    (23 + 1) / 25]                                                                                [I 14:12:58.327 NotebookApp] Saving file at /Test.ipynb
[IPKernelApp] ERROR | Error in message handler
Traceback (most recent call last):
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 461, in dispatch_queue
    await self.process_one()
  File "/home/user/.local/lib/python3.8/site-packages/ipykernel/kernelbase.py", line 450, in process_one
    await dispatch(*args)
TypeError: object NoneType can't be used in 'await' expression
[I 14:14:58.416 NotebookApp] Saving file at /Test.ipynb
[I 14:26:58.748 NotebookApp] Saving file at /Test.ipynb
[I 14:28:58.812 NotebookApp] Saving file at /Test.ipynb
[I 14:30:58.853 NotebookApp] Saving file at /Test.ipynb
[Stage 52:============================================>         (164 + 1) / 200]                                                                                [I 14:32:58.860 NotebookApp] Saving file at /Test.ipynb
[I 14:34:58.854 NotebookApp] Saving file at /Test.ipynb
[I 15:52:58.885 NotebookApp] Saving file at /Test.ipynb
[I 15:54:58.855 NotebookApp] Saving file at /Test.ipynb
[Stage 90:====>                                                  (16 + 1) / 200][Stage 90:======>                                                (23 + 1) / 200][Stage 90:========>                                              (31 + 1) / 200][Stage 90:==========>                                            (39 + 1) / 200][Stage 90:============>                                          (45 + 1) / 200][Stage 90:==============>                                        (52 + 1) / 200][Stage 90:================>                                      (61 + 1) / 200][Stage 90:===================>                                   (72 + 1) / 200][Stage 90:=====================>                                 (78 + 1) / 200][Stage 90:=======================>                               (86 + 1) / 200][Stage 90:=========================>                             (94 + 1) / 200][Stage 90:===========================>                          (102 + 1) / 200][Stage 90:=============================>                        (110 + 1) / 200][Stage 90:===============================>                      (118 + 1) / 200][Stage 90:==================================>                   (126 + 1) / 200][Stage 90:====================================>                 (134 + 1) / 200][Stage 90:=====================================>                (139 + 1) / 200][Stage 90:=======================================>              (148 + 1) / 200][Stage 90:==========================================>           (157 + 1) / 200][Stage 90:============================================>         (165 + 1) / 200][Stage 90:==============================================>       (172 + 1) / 200][Stage 90:================================================>     (180 + 1) / 200][Stage 90:==================================================>   (186 + 1) / 200][Stage 90:====================================================> (193 + 1) / 200]                                                                                [Stage 92:=========================>                             (93 + 1) / 200][Stage 92:================================>                     (122 + 1) / 200][Stage 92:=========================================>            (154 + 2) / 200][Stage 92:=================================================>    (185 + 1) / 200]                                                                                [Stage 107:=================>                                    (66 + 1) / 200][Stage 107:========================>                             (89 + 1) / 200][Stage 107:=============================>                       (112 + 1) / 200][Stage 107:==================================>                  (130 + 1) / 200][Stage 107:=========================================>           (158 + 1) / 200][Stage 107:===============================================>     (180 + 1) / 200][Stage 108:======>                                               (24 + 1) / 200][Stage 108:=========>                                            (34 + 1) / 200][Stage 108:===========>                                          (42 + 1) / 200][Stage 108:=============>                                        (51 + 1) / 200][Stage 108:===============>                                      (56 + 1) / 200][Stage 108:==================>                                   (68 + 1) / 200][Stage 108:====================>                                 (77 + 1) / 200][Stage 108:======================>                               (85 + 1) / 200][Stage 108:========================>                             (92 + 1) / 200][Stage 108:==========================>                           (98 + 1) / 200][Stage 108:===========================>                         (105 + 1) / 200][Stage 108:============================>                        (109 + 1) / 200][Stage 108:=============================>                       (112 + 1) / 200][Stage 108:================================>                    (122 + 1) / 200][Stage 108:==================================>                  (131 + 1) / 200][Stage 108:====================================>                (137 + 1) / 200][Stage 108:=======================================>             (150 + 1) / 200][Stage 108:==========================================>          (160 + 1) / 200][Stage 108:============================================>        (167 + 2) / 200][Stage 108:=============================================>       (173 + 1) / 200][Stage 108:================================================>    (183 + 1) / 200][Stage 108:==================================================>  (192 + 1) / 200]                                                                                [Stage 113:====>                                                   (2 + 1) / 25][Stage 113:======>                                                 (3 + 1) / 25][Stage 113:========>                                               (4 + 1) / 25][Stage 113:===========>                                            (5 + 1) / 25][Stage 113:=============>                                          (6 + 1) / 25][Stage 113:===============>                                        (7 + 1) / 25][Stage 113:=================>                                      (8 + 1) / 25][Stage 113:====================>                                   (9 + 1) / 25][Stage 113:======================>                                (10 + 1) / 25][Stage 113:========================>                              (11 + 1) / 25][Stage 113:==========================>                            (12 + 1) / 25][Stage 113:============================>                          (13 + 1) / 25][Stage 113:==============================>                        (14 + 1) / 25][Stage 113:=================================>                     (15 + 1) / 25][Stage 113:===================================>                   (16 + 1) / 25][Stage 113:=====================================>                 (17 + 1) / 25][Stage 113:=======================================>               (18 + 1) / 25][Stage 113:=========================================>             (19 + 1) / 25][Stage 113:============================================>          (20 + 1) / 25][Stage 113:==============================================>        (21 + 1) / 25][Stage 113:================================================>      (22 + 1) / 25][Stage 113:==================================================>    (23 + 1) / 25][Stage 113:====================================================>  (24 + 1) / 25]                                                                                [I 15:56:58.855 NotebookApp] Saving file at /Test.ipynb
[I 15:58:58.964 NotebookApp] Saving file at /Test.ipynb
[Stage 118:========>                                               (3 + 1) / 19][Stage 118:===========>                                            (4 + 1) / 19][Stage 118:==============>                                         (5 + 1) / 19][Stage 118:=================>                                      (6 + 1) / 19][Stage 118:====================>                                   (7 + 1) / 19][Stage 118:=======================>                                (8 + 1) / 19][Stage 118:==========================>                             (9 + 1) / 19][Stage 118:============================>                          (10 + 1) / 19][Stage 118:===============================>                       (11 + 1) / 19][Stage 118:==================================>                    (12 + 1) / 19][Stage 118:=====================================>                 (13 + 1) / 19][Stage 118:===========================================>           (15 + 1) / 19][Stage 118:==============================================>        (16 + 1) / 19][Stage 118:=================================================>     (17 + 1) / 19][Stage 118:====================================================>  (18 + 1) / 19]                                                                                [Stage 120:=====>                                                  (2 + 1) / 19][Stage 120:========>                                               (3 + 1) / 19][Stage 120:===========>                                            (4 + 1) / 19][Stage 120:==============>                                         (5 + 1) / 19][Stage 120:=================>                                      (6 + 1) / 19][Stage 120:====================>                                   (7 + 1) / 19][Stage 120:=======================>                                (8 + 1) / 19][Stage 120:==========================>                             (9 + 1) / 19][Stage 120:============================>                          (10 + 1) / 19][Stage 120:===============================>                       (11 + 1) / 19][Stage 120:=====================================>                 (13 + 1) / 19][Stage 120:========================================>              (14 + 1) / 19][Stage 120:===========================================>           (15 + 1) / 19][Stage 120:=================================================>     (17 + 1) / 19][Stage 120:====================================================>  (18 + 1) / 19][Stage 121:======================>                               (84 + 1) / 200][Stage 121:=============================>                       (113 + 1) / 200][Stage 121:======================================>              (145 + 1) / 200][Stage 121:==============================================>      (176 + 1) / 200]                                                                                [I 16:30:58.858 NotebookApp] Saving file at /Test.ipynb
[Stage 124:=========>                                              (3 + 1) / 17][Stage 124:=============>                                          (4 + 1) / 17][Stage 124:================>                                       (5 + 1) / 17][Stage 124:===================>                                    (6 + 1) / 17][Stage 124:=======================>                                (7 + 1) / 17][Stage 124:==========================>                             (8 + 1) / 17][Stage 124:================================>                      (10 + 1) / 17][Stage 124:===================================>                   (11 + 1) / 17][Stage 124:==========================================>            (13 + 1) / 17][Stage 124:=============================================>         (14 + 1) / 17][Stage 124:===================================================>   (16 + 1) / 17]                                                                                [Stage 126:===>                                                    (1 + 1) / 17][Stage 126:======>                                                 (2 + 1) / 17][Stage 126:=========>                                              (3 + 1) / 17][Stage 126:=============>                                          (4 + 1) / 17][Stage 126:================>                                       (5 + 1) / 17][Stage 126:===================>                                    (6 + 1) / 17][Stage 126:=======================>                                (7 + 1) / 17][Stage 126:==========================>                             (8 + 1) / 17][Stage 126:=============================>                          (9 + 1) / 17][Stage 126:================================>                      (10 + 1) / 17][Stage 126:===================================>                   (11 + 1) / 17][Stage 126:======================================>                (12 + 1) / 17][Stage 126:==========================================>            (13 + 1) / 17][Stage 126:=============================================>         (14 + 1) / 17][Stage 126:================================================>      (15 + 1) / 17][Stage 126:===================================================>   (16 + 1) / 17][Stage 127:==================>                                   (67 + 1) / 200][Stage 127:=========================>                            (94 + 1) / 200][Stage 127:==============================>                      (115 + 1) / 200][Stage 127:=======================================>             (148 + 1) / 200][Stage 127:=============================================>       (173 + 1) / 200][Stage 127:===================================================> (196 + 1) / 200]                                                                                [Stage 129:======>                                                 (4 + 1) / 36][Stage 129:=======>                                                (5 + 1) / 36][Stage 129:==========>                                             (7 + 1) / 36][Stage 129:============>                                           (8 + 1) / 36][Stage 129:==============>                                         (9 + 1) / 36][Stage 129:================>                                      (11 + 1) / 36][Stage 129:==================>                                    (12 + 1) / 36][Stage 129:===================>                                   (13 + 1) / 36][Stage 129:======================>                                (15 + 1) / 36][Stage 129:=========================>                             (17 + 1) / 36][Stage 129:===========================>                           (18 + 1) / 36][Stage 129:=============================>                         (19 + 1) / 36][Stage 129:================================>                      (21 + 1) / 36][Stage 129:=================================>                     (22 + 1) / 36][Stage 129:====================================>                  (24 + 1) / 36][Stage 129:======================================>                (25 + 1) / 36][Stage 129:=======================================>               (26 + 1) / 36][Stage 129:=========================================>             (27 + 1) / 36][Stage 129:============================================>          (29 + 1) / 36][Stage 129:=============================================>         (30 + 1) / 36][Stage 129:===============================================>       (31 + 1) / 36][Stage 129:================================================>      (32 + 1) / 36][Stage 129:===================================================>   (34 + 1) / 36][Stage 129:=====================================================> (35 + 1) / 36]                                                                                [I 16:32:58.856 NotebookApp] Saving file at /Test.ipynb
[I 23:52:12.077 NotebookApp] Saving file at /Test.ipynb
[I 23:52:15.968 NotebookApp] Starting buffering for 3484497c-9631-4433-8df6-8209a5adf491:6ee5a9cd5e284860902e304a09ff5767
[W 00:29:31.988 NotebookApp] Notebook Test.ipynb is not trusted
[Stage 134:============>                                         (45 + 1) / 200][Stage 134:====================>                                 (75 + 1) / 200][Stage 134:==========================>                          (101 + 1) / 200][Stage 134:===================================>                 (133 + 1) / 200][Stage 134:===========================================>         (165 + 1) / 200]                                                                                [I 00:31:32.804 NotebookApp] Saving file at /Test.ipynb
[W 00:31:32.806 NotebookApp] Notebook Test.ipynb is not trusted
[I 00:33:32.969 NotebookApp] Saving file at /Test.ipynb
[W 00:33:32.972 NotebookApp] Notebook Test.ipynb is not trusted
[I 00:35:04.074 NotebookApp] Starting buffering for 3484497c-9631-4433-8df6-8209a5adf491:a2337cb9247342c7b72e65a5b4949a79
